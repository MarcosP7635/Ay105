\documentclass[11pt]{article}

    \usepackage[breakable]{tcolorbox}
    \usepackage{parskip} % Stop auto-indenting (to mimic markdown behaviour)
    

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % Maintain compatibility with old templates. Remove in nbconvert 6.0
    \let\Oldincludegraphics\includegraphics
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionFormat{nocaption}{}
    \captionsetup{format=nocaption,aboveskip=0pt,belowskip=0pt}

    \usepackage{float}
    \floatplacement{figure}{H} % forces figures to be placed at the correct location
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro

    \usepackage{iftex}
    \ifPDFTeX
        \usepackage[T1]{fontenc}
        \IfFileExists{alphabeta.sty}{
              \usepackage{alphabeta}
          }{
              \usepackage[mathletters]{ucs}
              \usepackage[utf8x]{inputenc}
          }
    \else
        \usepackage{fontspec}
        \usepackage{unicode-math}
    \fi

    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics
                         % to support a larger range
    \makeatletter % fix for old versions of grffile with XeLaTeX
    \@ifpackagelater{grffile}{2019/11/01}
    {
      % Do nothing on new versions
    }
    {
      \def\Gread@@xetex#1{%
        \IfFileExists{"\Gin@base".bb}%
        {\Gread@eps{\Gin@base.bb}}%
        {\Gread@@xetex@aux#1}%
      }
    }
    \makeatother
    \usepackage[Export]{adjustbox} % Used to constrain images to a maximum size
    \adjustboxset{max size={0.9\linewidth}{0.9\paperheight}}

    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    % The default LaTeX title has an obnoxious amount of whitespace. By default,
    % titling removes some of it. It also provides customization options.
    \usepackage{titling}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage{array}     % table support for pandoc >= 2.11.3
    \usepackage{calc}      % table minipage width calculation for pandoc >= 2.11.1
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    \usepackage{mathrsfs}
    

    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}
    \definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
    \definecolor{ansi-default-inverse-bg}{HTML}{000000}

    % common color for the border for error outputs.
    \definecolor{outerrorbackground}{HTML}{FFDFDF}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}

    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}


    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatibility definitions
    \def\gt{>}
    \def\lt{<}
    \let\Oldtex\TeX
    \let\Oldlatex\LaTeX
    \renewcommand{\TeX}{\textrm{\Oldtex}}
    \renewcommand{\LaTeX}{\textrm{\Oldlatex}}
    % Document parameters
    % Document title
    \title{editing\_Ay105Lab8\_HBand-StarterNotebook}
    
    
    
    
    
% Pygments definitions
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\@namedef{PY@tok@w}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\@namedef{PY@tok@c}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cp}{\def\PY@tc##1{\textcolor[rgb]{0.61,0.40,0.00}{##1}}}
\@namedef{PY@tok@k}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kp}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kt}{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\@namedef{PY@tok@o}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@ow}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\@namedef{PY@tok@nb}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@nf}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@nc}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@nn}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@ne}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.80,0.25,0.22}{##1}}}
\@namedef{PY@tok@nv}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@no}{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\@namedef{PY@tok@nl}{\def\PY@tc##1{\textcolor[rgb]{0.46,0.46,0.00}{##1}}}
\@namedef{PY@tok@ni}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.44,0.44,0.44}{##1}}}
\@namedef{PY@tok@na}{\def\PY@tc##1{\textcolor[rgb]{0.41,0.47,0.13}{##1}}}
\@namedef{PY@tok@nt}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@nd}{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\@namedef{PY@tok@s}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sd}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@si}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.64,0.35,0.47}{##1}}}
\@namedef{PY@tok@se}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.36,0.12}{##1}}}
\@namedef{PY@tok@sr}{\def\PY@tc##1{\textcolor[rgb]{0.64,0.35,0.47}{##1}}}
\@namedef{PY@tok@ss}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@sx}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@m}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@gh}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\@namedef{PY@tok@gu}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\@namedef{PY@tok@gd}{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\@namedef{PY@tok@gi}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.52,0.00}{##1}}}
\@namedef{PY@tok@gr}{\def\PY@tc##1{\textcolor[rgb]{0.89,0.00,0.00}{##1}}}
\@namedef{PY@tok@ge}{\let\PY@it=\textit}
\@namedef{PY@tok@gs}{\let\PY@bf=\textbf}
\@namedef{PY@tok@gp}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\@namedef{PY@tok@go}{\def\PY@tc##1{\textcolor[rgb]{0.44,0.44,0.44}{##1}}}
\@namedef{PY@tok@gt}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\@namedef{PY@tok@err}{\def\PY@bc##1{{\setlength{\fboxsep}{\string -\fboxrule}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}}
\@namedef{PY@tok@kc}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kd}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kn}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kr}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@bp}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@fm}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@vc}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vg}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vi}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vm}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@sa}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sb}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sc}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@dl}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@s2}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sh}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@s1}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@mb}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mf}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mh}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mi}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@il}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mo}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@ch}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cm}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cpf}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@c1}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cs}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % For linebreaks inside Verbatim environment from package fancyvrb.
    \makeatletter
        \newbox\Wrappedcontinuationbox
        \newbox\Wrappedvisiblespacebox
        \newcommand*\Wrappedvisiblespace {\textcolor{red}{\textvisiblespace}}
        \newcommand*\Wrappedcontinuationsymbol {\textcolor{red}{\llap{\tiny$\m@th\hookrightarrow$}}}
        \newcommand*\Wrappedcontinuationindent {3ex }
        \newcommand*\Wrappedafterbreak {\kern\Wrappedcontinuationindent\copy\Wrappedcontinuationbox}
        % Take advantage of the already applied Pygments mark-up to insert
        % potential linebreaks for TeX processing.
        %        {, <, #, %, $, ' and ": go to next line.
        %        _, }, ^, &, >, - and ~: stay at end of broken line.
        % Use of \textquotesingle for straight quote.
        \newcommand*\Wrappedbreaksatspecials {%
            \def\PYGZus{\discretionary{\char`\_}{\Wrappedafterbreak}{\char`\_}}%
            \def\PYGZob{\discretionary{}{\Wrappedafterbreak\char`\{}{\char`\{}}%
            \def\PYGZcb{\discretionary{\char`\}}{\Wrappedafterbreak}{\char`\}}}%
            \def\PYGZca{\discretionary{\char`\^}{\Wrappedafterbreak}{\char`\^}}%
            \def\PYGZam{\discretionary{\char`\&}{\Wrappedafterbreak}{\char`\&}}%
            \def\PYGZlt{\discretionary{}{\Wrappedafterbreak\char`\<}{\char`\<}}%
            \def\PYGZgt{\discretionary{\char`\>}{\Wrappedafterbreak}{\char`\>}}%
            \def\PYGZsh{\discretionary{}{\Wrappedafterbreak\char`\#}{\char`\#}}%
            \def\PYGZpc{\discretionary{}{\Wrappedafterbreak\char`\%}{\char`\%}}%
            \def\PYGZdl{\discretionary{}{\Wrappedafterbreak\char`\$}{\char`\$}}%
            \def\PYGZhy{\discretionary{\char`\-}{\Wrappedafterbreak}{\char`\-}}%
            \def\PYGZsq{\discretionary{}{\Wrappedafterbreak\textquotesingle}{\textquotesingle}}%
            \def\PYGZdq{\discretionary{}{\Wrappedafterbreak\char`\"}{\char`\"}}%
            \def\PYGZti{\discretionary{\char`\~}{\Wrappedafterbreak}{\char`\~}}%
        }
        % Some characters . , ; ? ! / are not pygmentized.
        % This macro makes them "active" and they will insert potential linebreaks
        \newcommand*\Wrappedbreaksatpunct {%
            \lccode`\~`\.\lowercase{\def~}{\discretionary{\hbox{\char`\.}}{\Wrappedafterbreak}{\hbox{\char`\.}}}%
            \lccode`\~`\,\lowercase{\def~}{\discretionary{\hbox{\char`\,}}{\Wrappedafterbreak}{\hbox{\char`\,}}}%
            \lccode`\~`\;\lowercase{\def~}{\discretionary{\hbox{\char`\;}}{\Wrappedafterbreak}{\hbox{\char`\;}}}%
            \lccode`\~`\:\lowercase{\def~}{\discretionary{\hbox{\char`\:}}{\Wrappedafterbreak}{\hbox{\char`\:}}}%
            \lccode`\~`\?\lowercase{\def~}{\discretionary{\hbox{\char`\?}}{\Wrappedafterbreak}{\hbox{\char`\?}}}%
            \lccode`\~`\!\lowercase{\def~}{\discretionary{\hbox{\char`\!}}{\Wrappedafterbreak}{\hbox{\char`\!}}}%
            \lccode`\~`\/\lowercase{\def~}{\discretionary{\hbox{\char`\/}}{\Wrappedafterbreak}{\hbox{\char`\/}}}%
            \catcode`\.\active
            \catcode`\,\active
            \catcode`\;\active
            \catcode`\:\active
            \catcode`\?\active
            \catcode`\!\active
            \catcode`\/\active
            \lccode`\~`\~
        }
    \makeatother

    \let\OriginalVerbatim=\Verbatim
    \makeatletter
    \renewcommand{\Verbatim}[1][1]{%
        %\parskip\z@skip
        \sbox\Wrappedcontinuationbox {\Wrappedcontinuationsymbol}%
        \sbox\Wrappedvisiblespacebox {\FV@SetupFont\Wrappedvisiblespace}%
        \def\FancyVerbFormatLine ##1{\hsize\linewidth
            \vtop{\raggedright\hyphenpenalty\z@\exhyphenpenalty\z@
                \doublehyphendemerits\z@\finalhyphendemerits\z@
                \strut ##1\strut}%
        }%
        % If the linebreak is at a space, the latter will be displayed as visible
        % space at end of first line, and a continuation symbol starts next line.
        % Stretch/shrink are however usually zero for typewriter font.
        \def\FV@Space {%
            \nobreak\hskip\z@ plus\fontdimen3\font minus\fontdimen4\font
            \discretionary{\copy\Wrappedvisiblespacebox}{\Wrappedafterbreak}
            {\kern\fontdimen2\font}%
        }%

        % Allow breaks at special characters using \PYG... macros.
        \Wrappedbreaksatspecials
        % Breaks at punctuation characters . , ; ? ! and / need catcode=\active
        \OriginalVerbatim[#1,codes*=\Wrappedbreaksatpunct]%
    }
    \makeatother

    % Exact colors from NB
    \definecolor{incolor}{HTML}{303F9F}
    \definecolor{outcolor}{HTML}{D84315}
    \definecolor{cellborder}{HTML}{CFCFCF}
    \definecolor{cellbackground}{HTML}{F7F7F7}

    % prompt
    \makeatletter
    \newcommand{\boxspacing}{\kern\kvtcb@left@rule\kern\kvtcb@boxsep}
    \makeatother
    \newcommand{\prompt}[4]{
        {\ttfamily\llap{{\color{#2}[#3]:\hspace{3pt}#4}}\vspace{-\baselineskip}}
    }
    

    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

\begin{document}
    
    \maketitle
    
    

    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{1}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{photutils}\PY{n+nn}{.}\PY{n+nn}{detection} \PY{k+kn}{import} \PY{n}{find\PYZus{}peaks}
\PY{k+kn}{from} \PY{n+nn}{photutils} \PY{k+kn}{import} \PY{n}{DAOStarFinder}
\PY{k+kn}{from} \PY{n+nn}{astropy}\PY{n+nn}{.}\PY{n+nn}{stats} \PY{k+kn}{import} \PY{n}{mad\PYZus{}std}
\PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
\PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
\PY{k+kn}{import} \PY{n+nn}{vip\PYZus{}hci}
\PY{k+kn}{from} \PY{n+nn}{os} \PY{k+kn}{import} \PY{n}{mkdir}
\PY{k+kn}{from} \PY{n+nn}{os}\PY{n+nn}{.}\PY{n+nn}{path} \PY{k+kn}{import} \PY{n}{join}\PY{p}{,} \PY{n}{sep}\PY{p}{,}\PY{n}{exists}
\PY{k+kn}{import} \PY{n+nn}{glob}
\PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
\PY{k+kn}{from} \PY{n+nn}{astropy}\PY{n+nn}{.}\PY{n+nn}{io} \PY{k+kn}{import} \PY{n}{fits}
\PY{k+kn}{from} \PY{n+nn}{astropy} \PY{k+kn}{import} \PY{n}{stats}
\PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{ndimage}\PY{n+nn}{.}\PY{n+nn}{filters} \PY{k+kn}{import} \PY{n}{median\PYZus{}filter}
\PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{ndimage}\PY{n+nn}{.}\PY{n+nn}{interpolation} \PY{k+kn}{import} \PY{n}{shift}
\PY{k+kn}{from} \PY{n+nn}{photutils} \PY{k+kn}{import} \PY{n}{DAOStarFinder}
\PY{k+kn}{from} \PY{n+nn}{astropy}\PY{n+nn}{.}\PY{n+nn}{stats} \PY{k+kn}{import} \PY{n}{mad\PYZus{}std}
\PY{k+kn}{from} \PY{n+nn}{photutils} \PY{k+kn}{import} \PY{n}{aperture\PYZus{}photometry}\PY{p}{,} \PY{n}{CircularAperture}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
/tmp/ipykernel\_6254/2583921279.py:2: DeprecationWarning:
`photutils.DAOStarFinder` is a deprecated alias for
`photutils.detection.DAOStarFinder` and will be removed in the future. Instead,
please use `from photutils.detection import DAOStarFinder` to silence this
warning.
  from photutils import DAOStarFinder
    \end{Verbatim}

    Perform H Band reduction

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{2}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Set up paths }
\PY{n}{frameSize} \PY{o}{=} \PY{l+m+mi}{351}
\PY{n}{band} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{H}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{tg\PYZus{}name}\PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2M1207}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{useRefFrames} \PY{o}{=} \PY{k+kc}{False}
\PY{n}{path\PYZus{}input} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/home/ubuntu/Downloads/2M1207\PYZus{}bands/Hband/}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{path\PYZus{}output} \PY{o}{=} \PY{n}{path\PYZus{}input} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{out/}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{sep}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/}\PY{l+s+s1}{\PYZsq{}}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{path\PYZus{}input}\PY{p}{)}

\PY{n}{path\PYZus{}flats} \PY{o}{=} \PY{n}{path\PYZus{}input}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{flats}\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{n}{sep}
\PY{n}{path\PYZus{}flats\PYZus{}darks} \PY{o}{=} \PY{n}{path\PYZus{}input}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{flats/darks}\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{n}{sep}
\PY{n}{path\PYZus{}sci} \PY{o}{=} \PY{n}{path\PYZus{}input}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sci}\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{n}{sep}
\PY{n}{path\PYZus{}darks} \PY{o}{=} \PY{n}{path\PYZus{}input}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{darks}\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{n}{sep}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
/home/ubuntu/Downloads/2M1207\_bands/Hband/
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{3}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} File list}
\PY{n}{filelist\PYZus{}flats} \PY{o}{=} \PY{n}{glob}\PY{o}{.}\PY{n}{glob}\PY{p}{(}\PY{n}{path\PYZus{}flats}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{*.fits}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{filelist\PYZus{}flats\PYZus{}darks} \PY{o}{=} \PY{n}{glob}\PY{o}{.}\PY{n}{glob}\PY{p}{(}\PY{n}{path\PYZus{}flats\PYZus{}darks}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{*.fits}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{filelist\PYZus{}sci} \PY{o}{=} \PY{n+nb}{sorted}\PY{p}{(}\PY{n}{glob}\PY{o}{.}\PY{n}{glob}\PY{p}{(}\PY{n}{path\PYZus{}sci}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{*.fits}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
\PY{n}{filelist\PYZus{}darks} \PY{o}{=} \PY{n}{glob}\PY{o}{.}\PY{n}{glob}\PY{p}{(}\PY{n}{path\PYZus{}darks}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{*.fits}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n+nb}{print}\PY{p}{(}\PY{p}{(}\PY{n}{filelist\PYZus{}sci}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
['/home/ubuntu/Downloads/2M1207\_bands/Hband/sci/NACO.2004-04-
27T03\_54\_41.920.fits', '/home/ubuntu/Downloads/2M1207\_bands/Hband/sci/NACO.2004-
04-27T03\_56\_08.901.fits', '/home/ubuntu/Downloads/2M1207\_bands/Hband/sci/NACO.20
04-04-27T03\_57\_35.981.fits', '/home/ubuntu/Downloads/2M1207\_bands/Hband/sci/NACO
.2004-04-27T03\_59\_03.178.fits', '/home/ubuntu/Downloads/2M1207\_bands/Hband/sci/N
ACO.2004-04-27T04\_00\_51.350.fits', '/home/ubuntu/Downloads/2M1207\_bands/Hband/sc
i/NACO.2004-04-27T04\_02\_18.216.fits', '/home/ubuntu/Downloads/2M1207\_bands/Hband
/sci/NACO.2004-04-27T04\_03\_44.710.fits', '/home/ubuntu/Downloads/2M1207\_bands/Hb
and/sci/NACO.2004-04-27T04\_05\_11.355.fits']
    \end{Verbatim}

    \hypertarget{h-band-raw-image}{%
\section{H BAND RAW IMAGE}\label{h-band-raw-image}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{4}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{raw\PYZus{}sci} \PY{o}{=} \PY{n}{fits}\PY{o}{.}\PY{n}{open}\PY{p}{(}\PY{n}{filelist\PYZus{}sci}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{data}
\PY{n}{crop} \PY{o}{=} \PY{l+m+mi}{128}
\PY{n}{dimx} \PY{o}{=} \PY{n}{raw\PYZus{}sci}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\PY{n}{dimy} \PY{o}{=} \PY{n}{raw\PYZus{}sci}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
\PY{n}{x1} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{p}{(}\PY{n}{dimx} \PY{o}{\PYZhy{}} \PY{n}{crop}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)}
\PY{n}{x2} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n}{x1} \PY{o}{+} \PY{n}{crop}\PY{p}{)}
\PY{n}{y1} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{p}{(}\PY{n}{dimy} \PY{o}{\PYZhy{}} \PY{n}{crop}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)}
\PY{n}{y2} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n}{y1} \PY{o}{+} \PY{n}{crop}\PY{p}{)}
\PY{n}{raw\PYZus{}sci} \PY{o}{=} \PY{n}{shift}\PY{p}{(}\PY{n}{raw\PYZus{}sci}\PY{p}{,}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{100}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{100}\PY{p}{]}\PY{p}{)}
\PY{n}{raw\PYZus{}cropped} \PY{o}{=} \PY{n}{raw\PYZus{}sci}\PY{p}{[}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{,}\PY{n}{y1}\PY{p}{:}\PY{n}{y2}\PY{p}{]}
\PY{n}{raw\PYZus{}cropped}\PY{o}{.}\PY{n}{shape}
\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{)}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{raw\PYZus{}cropped}\PY{p}{,}\PY{n}{vmin}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{vmax}\PY{o}{=}\PY{l+m+mi}{200}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{hot}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}\PY{p}{;}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_5_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    The above pixel values are simply what were measured on the CCD when
attempting to observe the exoplanet 2M1207, with no editing or
corrections yet.

We wrote a function to crop a given frame to crop the darks, flats, and
biases as well as to make sure they are cropped the same way as the raw
science frame.

    https://docs.astropy.org/en/stable/api/astropy.stats.mad\_std.html

mad\_std is the median absolute deviation (1.4826 times larger than the
standard deviation for a normal distribution) and is \begin{align}
\text{MAD} = \text{median}(|X_i - \text{median}(X)|)
\end{align}

The below function named characterize implements the function named
mad\_std and also returns important statistics for a given image.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{5}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{characterize}\PY{p}{(}\PY{n}{frame}\PY{p}{,} \PY{n}{give\PYZus{}nums} \PY{o}{=} \PY{k+kc}{False}\PY{p}{)}\PY{p}{:}
    \PY{n}{avg}\PY{p}{,} \PY{n}{med} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{average}\PY{p}{(}\PY{n}{frame}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{median}\PY{p}{(}\PY{n}{frame}\PY{p}{)}
    \PY{n}{SD}\PY{p}{,} \PY{n}{MAD} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{n}{frame}\PY{p}{)}\PY{p}{,} \PY{n}{mad\PYZus{}std}\PY{p}{(}\PY{n}{frame}\PY{p}{)}
    \PY{k}{if} \PY{n}{give\PYZus{}nums}\PY{p}{:}
        \PY{n}{stat\PYZus{}dict} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
        \PY{n}{stat\PYZus{}dict}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{average}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{stat\PYZus{}dict}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{standard deviation}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{avg}\PY{p}{,} \PY{n}{SD}
        \PY{n}{stat\PYZus{}dict}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{median absolute deviation}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{MAD}
        \PY{n}{stat\PYZus{}dict}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{median}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{med}
        \PY{k}{return} \PY{n}{stat\PYZus{}dict}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{We now statistically characterize the pixel values in the }\PY{l+s+s2}{\PYZdq{}}
         \PY{o}{+} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{above image.}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{The average is }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{avg}\PY{p}{)} \PY{o}{+} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} 
         \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{The median is }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{med}\PY{p}{)} \PY{o}{+} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} 
          \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{The standard deviation is }\PY{l+s+s2}{\PYZdq{}}\PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{SD}\PY{p}{)} \PY{o}{+} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} 
         \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{The median absolute deviation is }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{MAD}\PY{p}{)} \PY{o}{+} 
          \PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A histogram of the pixel value is shown below.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{hist}\PY{p}{(}\PY{n}{frame}\PY{p}{)}
\PY{n}{characterize}\PY{p}{(}\PY{n}{raw\PYZus{}cropped}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
We now statistically characterize the pixel values in the above image.
The average is 43.6221
The median is 39.0
The standard deviation is 52.145508
The median absolute deviation is 10.378215529539215
A histogram of the pixel value is shown below.
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_8_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{h-band-master-darks}{%
\subsection{H BAND MASTER DARKS}\label{h-band-master-darks}}

    The function get\_frames retrieves all of the frames for a given band.
The options are one of the following strings: ``Hband'', ``Jband'',
``Kband'', or ``Lband'' since those are the names of the directories for
each wavelength band.

The function get\_frames returns a dictionary. To access the flats
simply use frames\_dict{[}`flats'{]}

The function get\_frames\_dir is a helper function that reads every
.fits file for each type of exposure: `flats' , `dark flats' which have
a different exposure as reported above, `sci' for science, and `darks'.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{6}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{get\PYZus{}frames}\PY{p}{(}\PY{n}{band}\PY{p}{,} \PY{n}{path\PYZus{}input} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/home/ubuntu/Downloads/2M1207\PYZus{}bands/}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{sep} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
    \PY{n}{frames\PYZus{}dict} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
    \PY{n}{path\PYZus{}input} \PY{o}{=} \PY{n}{path\PYZus{}input} \PY{o}{+} \PY{n}{band} \PY{o}{+} \PY{n}{sep}
    \PY{n}{frames\PYZus{}dict}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{flats}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{get\PYZus{}frames\PYZus{}from\PYZus{}dir}\PY{p}{(}\PY{n}{path\PYZus{}input}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{flats}\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{n}{sep}\PY{p}{)}
    \PY{n}{frames\PYZus{}dict}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{flat darks}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{get\PYZus{}frames\PYZus{}from\PYZus{}dir}\PY{p}{(}\PY{n}{path\PYZus{}input}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{flats}\PY{l+s+s1}{\PYZsq{}} 
                                                    \PY{o}{+} \PY{n}{sep} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{darks}\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{n}{sep}\PY{p}{)}
    \PY{n}{frames\PYZus{}dict}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sci}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{get\PYZus{}frames\PYZus{}from\PYZus{}dir}\PY{p}{(}\PY{n}{path\PYZus{}input}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sci}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{sep}\PY{p}{)}
    \PY{n}{frames\PYZus{}dict}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{darks}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{get\PYZus{}frames\PYZus{}from\PYZus{}dir}\PY{p}{(}\PY{n}{path\PYZus{}input}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{darks}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{sep}\PY{p}{)}
    \PY{k}{return} \PY{n}{frames\PYZus{}dict}

\PY{k}{def} \PY{n+nf}{get\PYZus{}frames\PYZus{}from\PYZus{}dir}\PY{p}{(}\PY{n}{dir\PYZus{}path}\PY{p}{)}\PY{p}{:}
    \PY{n}{frame\PYZus{}paths} \PY{o}{=} \PY{n}{glob}\PY{o}{.}\PY{n}{glob}\PY{p}{(}\PY{n}{dir\PYZus{}path} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{*.fits}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{k}{return} \PY{p}{[}\PY{n}{fits}\PY{o}{.}\PY{n}{open}\PY{p}{(}\PY{n}{frame\PYZus{}paths}\PY{p}{[}\PY{n}{file\PYZus{}num}\PY{p}{]}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{data}
                \PY{k}{for} \PY{n}{file\PYZus{}num} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{frame\PYZus{}paths}\PY{p}{)}\PY{p}{)}\PY{p}{]}

\PY{n}{jband\PYZus{}dict}\PY{p}{,} \PY{n}{hband\PYZus{}dict} \PY{o}{=} \PY{n}{get\PYZus{}frames}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Jband}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} \PY{n}{get\PYZus{}frames}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Hband}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{kband\PYZus{}dict}\PY{p}{,} \PY{n}{lband\PYZus{}dict} \PY{o}{=} \PY{n}{get\PYZus{}frames}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Kband}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} \PY{n}{get\PYZus{}frames}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Lband}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{hband\PYZus{}dict}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{darks}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{6}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
[array([[ 137.66667 ,  117.166664,  112.666664, {\ldots},  136.16667 ,
          124.5     ,  218.33333 ],
        [  66.166664,   53.333332,   74.666664, {\ldots},   37.833332,
           60.5     ,   44.333332],
        [  57.166668,   63.833332,  117.      , {\ldots},   70.833336,
          145.5     ,   54.333332],
        {\ldots},
        [  41.833332,    0.      ,   60.833332, {\ldots},   27.      ,
           54.166668,   29.833334],
        [  55.166668,  -53.166668,   33.166668, {\ldots},   23.833334,
           41.666668,   -0.5     ],
        [ -12.      , -166.5     ,  -20.166666, {\ldots},  -60.166668,
          -18.833334,  378.66666 ]], dtype='>f4'),
 array([[ 137.33333  ,  115.833336 ,  113.5      , {\ldots},  142.16667  ,
          121.833336 ,  217.83333  ],
        [  66.       ,   55.333332 ,   76.333336 , {\ldots},   44.333332 ,
           58.       ,   46.       ],
        [  55.166668 ,   62.5      ,  117.       , {\ldots},   73.       ,
          141.       ,   57.       ],
        {\ldots},
        [  53.5      ,    0.       ,   65.       , {\ldots},   29.166666 ,
           53.166668 ,   34.       ],
        [  63.333332 ,  -49.166668 ,   40.833332 , {\ldots},   24.       ,
           38.       ,   -2.3333333],
        [  -1.5      , -171.66667  ,  -13.666667 , {\ldots},  -60.       ,
          -18.       ,  377.66666  ]], dtype='>f4'),
 array([[ 136.      ,  119.166664,  111.666664, {\ldots},  137.66667 ,
          124.166664,  218.16667 ],
        [  63.5     ,   55.666668,   74.      , {\ldots},   43.      ,
           60.5     ,   48.5     ],
        [  54.166668,   58.833332,  116.333336, {\ldots},   72.5     ,
          142.66667 ,   54.166668],
        {\ldots},
        [  47.      ,    0.      ,   63.333332, {\ldots},   32.      ,
           59.166668,   36.5     ],
        [  53.333332,  -57.      ,   30.333334, {\ldots},   24.833334,
           39.166668,   -1.      ],
        [ -12.      , -168.16667 ,  -18.833334, {\ldots},  -61.833332,
          -16.5     ,  367.66666 ]], dtype='>f4')]
\end{Verbatim}
\end{tcolorbox}
        
    https://photutils.readthedocs.io/en/stable/detection.html

https://stackoverflow.com/questions/62926893/finding-median-value-of-multiple-numpy-arrays

    \hypertarget{h-band-master-flat-dark}{%
\subsubsection{H BAND MASTER FLAT DARK}\label{h-band-master-flat-dark}}

Here we take the difference between a dark and a dark flat to be that
the dark flat has a longer exposure time. We verify this below

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{7}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}type(test\PYZus{}flat[0]), type(median\PYZus{}hband\PYZus{}flat)}
\PY{n}{test\PYZus{}path} \PY{o}{=} \PY{n}{path\PYZus{}input} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/flats/darks/}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{test\PYZus{}file} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NACO.2004\PYZhy{}04\PYZhy{}29T11\PYZus{}38\PYZus{}58.492.fits}\PY{l+s+s1}{\PYZsq{}}
\PY{k}{with} \PY{n}{fits}\PY{o}{.}\PY{n}{open}\PY{p}{(}\PY{n}{test\PYZus{}path} \PY{o}{+} \PY{n}{test\PYZus{}file}\PY{p}{)} \PY{k}{as} \PY{n}{hdul}\PY{p}{:}
    \PY{c+c1}{\PYZsh{}hdul.info()}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{For the Hband flat darks we have for the exposure time in seconds: }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} 
          \PY{n+nb}{str}\PY{p}{(}\PY{n}{hdul}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{header}\PY{o}{.}\PY{n}{tostring}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{split}\PY{p}{(}
              \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{EXPTIME = }\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)} \PY{p}{)} 
    \PY{c+c1}{\PYZsh{}print(dir(hdul[0].header))}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
For the Hband flat darks we have for the exposure time in seconds:
1.200
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{8}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{test\PYZus{}path} \PY{o}{=} \PY{n}{path\PYZus{}input} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/darks/}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{test\PYZus{}file} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NACO.2004\PYZhy{}04\PYZhy{}27T10\PYZus{}58\PYZus{}43.506.fits}\PY{l+s+s1}{\PYZsq{}}
\PY{k}{with} \PY{n}{fits}\PY{o}{.}\PY{n}{open}\PY{p}{(}\PY{n}{test\PYZus{}path} \PY{o}{+} \PY{n}{test\PYZus{}file}\PY{p}{)} \PY{k}{as} \PY{n}{hdul}\PY{p}{:}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{For the Hband darks we have for the exposure time in seconds: }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} 
          \PY{n+nb}{str}\PY{p}{(}\PY{n}{hdul}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{header}\PY{o}{.}\PY{n}{tostring}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{EXPTIME = }\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)} \PY{p}{)} 
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
For the Hband darks we have for the exposure time in seconds:
30.000
    \end{Verbatim}

    Which is the integration time reported in the original publication:
https://doi.org/10.1051/0004-6361:200400056

    This function returns a new frame where each pixel value is the median
of each corresponding pixel value from a given array of frames.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{9}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{get\PYZus{}median\PYZus{}frame}\PY{p}{(}\PY{n}{array\PYZus{}of\PYZus{}frames}\PY{p}{,} \PY{n}{crop}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{p}{:}
    \PY{k}{if} \PY{n}{crop}\PY{p}{:}
        \PY{n}{stacked\PYZus{}frames} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{stack}\PY{p}{(}\PY{p}{[}\PY{n}{make\PYZus{}crop}\PY{p}{(}\PY{n}{frame}\PY{p}{)} 
                               \PY{k}{for} \PY{n}{frame} \PY{o+ow}{in} \PY{n}{array\PYZus{}of\PYZus{}frames}\PY{p}{]}\PY{p}{)}
    \PY{k}{else}\PY{p}{:}
        \PY{n}{stacked\PYZus{}frames} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{stack}\PY{p}{(}\PY{n}{array\PYZus{}of\PYZus{}frames}\PY{p}{)}
    \PY{k}{return} \PY{n}{np}\PY{o}{.}\PY{n}{median}\PY{p}{(}\PY{n}{stacked\PYZus{}frames}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
\PY{k}{def} \PY{n+nf}{make\PYZus{}crop}\PY{p}{(}\PY{n}{image}\PY{p}{,} \PY{n}{crop} \PY{o}{=} \PY{l+m+mi}{128}\PY{p}{)}\PY{p}{:}
    \PY{n}{dimx}\PY{p}{,} \PY{n}{dimy} \PY{o}{=} \PY{n}{image}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{image}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
    \PY{n}{x1}\PY{p}{,} \PY{n}{y1} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{p}{(}\PY{n}{dimx} \PY{o}{\PYZhy{}} \PY{n}{crop}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{,} \PY{n+nb}{int}\PY{p}{(}\PY{p}{(}\PY{n}{dimy} \PY{o}{\PYZhy{}} \PY{n}{crop}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)} 
    \PY{n}{x2}\PY{p}{,} \PY{n}{y2} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n}{x1} \PY{o}{+} \PY{n}{crop}\PY{p}{)}\PY{p}{,} \PY{n+nb}{int}\PY{p}{(}\PY{n}{y1} \PY{o}{+} \PY{n}{crop}\PY{p}{)}
    \PY{n}{image} \PY{o}{=} \PY{n}{shift}\PY{p}{(}\PY{n}{image}\PY{p}{,} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{100}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{100}\PY{p}{]}\PY{p}{)}
    \PY{k}{return} \PY{n}{image}\PY{p}{[}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{,}\PY{n}{y1}\PY{p}{:}\PY{n}{y2}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{10}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{median\PYZus{}hband\PYZus{}short\PYZus{}dark} \PY{o}{=} \PY{n}{get\PYZus{}median\PYZus{}frame}\PY{p}{(}\PY{n}{hband\PYZus{}dict}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{flat darks}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{median\PYZus{}hband\PYZus{}short\PYZus{}dark}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{10}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
<matplotlib.colorbar.Colorbar at 0x7f14cb606190>
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_19_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{11}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{characterize}\PY{p}{(}\PY{n}{median\PYZus{}hband\PYZus{}short\PYZus{}dark}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
We now statistically characterize the pixel values in the above image.
The average is 20.485004
The median is 18.6
The standard deviation is 30.232597
The median absolute deviation is 8.154312201780812
A histogram of the pixel value is shown below.
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_20_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{12}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{median\PYZus{}hband\PYZus{}dark} \PY{o}{=} \PY{n}{get\PYZus{}median\PYZus{}frame}\PY{p}{(}\PY{n}{hband\PYZus{}dict}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{darks}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{median\PYZus{}hband\PYZus{}dark}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{12}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
<matplotlib.colorbar.Colorbar at 0x7f1486e977f0>
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_21_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{13}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{characterize}\PY{p}{(}\PY{n}{median\PYZus{}hband\PYZus{}dark}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
We now statistically characterize the pixel values in the above image.
The average is 27.180977
The median is 24.333334
The standard deviation is 60.837864
The median absolute deviation is 10.131113274562072
A histogram of the pixel value is shown below.
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_22_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{master-hband-flat-field}{%
\subsection{Master Hband Flat Field}\label{master-hband-flat-field}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{14}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{median\PYZus{}hband\PYZus{}flat} \PY{o}{=} \PY{n}{get\PYZus{}median\PYZus{}frame}\PY{p}{(}\PY{n}{hband\PYZus{}dict}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{flats}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{median\PYZus{}hband\PYZus{}flat}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{14}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
<matplotlib.colorbar.Colorbar at 0x7f14c36c6d60>
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_24_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{15}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{characterize}\PY{p}{(}\PY{n}{median\PYZus{}hband\PYZus{}flat}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
We now statistically characterize the pixel values in the above image.
The average is 1833.601
The median is 1882.2
The standard deviation is 291.16833
The median absolute deviation is 77.68821146432064
A histogram of the pixel value is shown below.
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_25_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{hband-bad-pixel-map}{%
\section{Hband Bad Pixel Map}\label{hband-bad-pixel-map}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{16}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{hband\PYZus{}dark\PYZus{}stats} \PY{o}{=} \PY{n}{characterize}\PY{p}{(}\PY{n}{median\PYZus{}hband\PYZus{}dark}\PY{p}{,} \PY{k+kc}{True}\PY{p}{)}
\PY{n}{hband\PYZus{}short\PYZus{}dark\PYZus{}stats} \PY{o}{=} \PY{n}{characterize}\PY{p}{(}\PY{n}{median\PYZus{}hband\PYZus{}short\PYZus{}dark}\PY{p}{,} \PY{k+kc}{True}\PY{p}{)}
\PY{n}{hband\PYZus{}flat\PYZus{}stats} \PY{o}{=} \PY{n}{characterize}\PY{p}{(}\PY{n}{median\PYZus{}hband\PYZus{}flat}\PY{p}{,} \PY{k+kc}{True}\PY{p}{)}
\PY{n}{hband\PYZus{}flat\PYZus{}stats}\PY{p}{,} \PY{n}{hband\PYZus{}short\PYZus{}dark\PYZus{}stats}\PY{p}{,} \PY{n}{hband\PYZus{}dark\PYZus{}stats}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{16}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
(\{'average': 1833.601,
  'standard deviation': 291.16833,
  'median absolute deviation': 77.68821146432064,
  'median': 1882.2\},
 \{'average': 20.485004,
  'standard deviation': 30.232597,
  'median absolute deviation': 8.154312201780812,
  'median': 18.6\},
 \{'average': 27.180977,
  'standard deviation': 60.837864,
  'median absolute deviation': 10.131113274562072,
  'median': 24.333334\})
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{17}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{verbatim\PYZus{}hot\PYZus{}pixels} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}
    \PY{n}{median\PYZus{}hband\PYZus{}flat} \PY{o}{\PYZgt{}} \PY{n}{hband\PYZus{}flat\PYZus{}stats}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{median}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                \PY{o}{+} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{hband\PYZus{}flat\PYZus{}stats}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{median absolute deviation}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{verbatim\PYZus{}cold\PYZus{}pixels} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}
    \PY{n}{median\PYZus{}hband\PYZus{}dark} \PY{o}{\PYZlt{}} \PY{n}{hband\PYZus{}dark\PYZus{}stats}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{median}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                \PY{o}{\PYZhy{}} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{hband\PYZus{}dark\PYZus{}stats}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{median absolute deviation}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\PY{n+nb}{len}\PY{p}{(}\PY{n}{verbatim\PYZus{}hot\PYZus{}pixels}\PY{p}{)}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{verbatim\PYZus{}cold\PYZus{}pixels}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{17}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
(10411, 6520)
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{18}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{cold\PYZus{}pixels} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}
    \PY{n}{median\PYZus{}hband\PYZus{}flat} \PY{o}{\PYZlt{}} \PY{n}{hband\PYZus{}flat\PYZus{}stats}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{median}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                \PY{o}{\PYZhy{}} \PY{l+m+mi}{3}\PY{o}{*}\PY{n}{hband\PYZus{}flat\PYZus{}stats}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{median absolute deviation}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{hot\PYZus{}pixels} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}
    \PY{n}{median\PYZus{}hband\PYZus{}dark} \PY{o}{\PYZgt{}} \PY{n}{hband\PYZus{}dark\PYZus{}stats}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{median}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                \PY{o}{+} \PY{l+m+mi}{3}\PY{o}{*}\PY{n}{hband\PYZus{}dark\PYZus{}stats}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{median absolute deviation}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\PY{n+nb}{len}\PY{p}{(}\PY{n}{hot\PYZus{}pixels}\PY{p}{)}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{cold\PYZus{}pixels}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{18}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
(33431, 33372)
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{19}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{bad\PYZus{}pixel\PYZus{}nested\PYZus{}arr} \PY{o}{=} \PY{p}{[}\PY{n}{hot\PYZus{}pixels}\PY{p}{,} \PY{n}{cold\PYZus{}pixels}\PY{p}{]}\PY{c+c1}{\PYZsh{}, verbatim\PYZus{}hot\PYZus{}pixels,}
                       \PY{c+c1}{\PYZsh{}verbatim\PYZus{}cold\PYZus{}pixels]}
\PY{n}{hband\PYZus{}bad\PYZus{}pixels} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{concatenate}\PY{p}{(}\PY{n}{bad\PYZus{}pixel\PYZus{}nested\PYZus{}arr}\PY{p}{)}
\PY{n}{check1} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{hband\PYZus{}bad\PYZus{}pixels}\PY{p}{)} \PY{o}{==} \PY{n+nb}{sum}\PY{p}{(}
    \PY{p}{[}\PY{n+nb}{len}\PY{p}{(}\PY{n}{x}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{bad\PYZus{}pixel\PYZus{}nested\PYZus{}arr}\PY{p}{]}\PY{p}{)}
\PY{n}{check2} \PY{o}{=} \PY{n+nb}{sum}\PY{p}{(}\PY{p}{[}\PY{n+nb}{len}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{o}{==}\PY{l+m+mi}{2} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{hband\PYZus{}bad\PYZus{}pixels}\PY{p}{]}\PY{p}{)} \PY{o}{==} \PY{n+nb}{len}\PY{p}{(}
    \PY{n}{hband\PYZus{}bad\PYZus{}pixels}\PY{p}{)}
\PY{k}{if} \PY{n}{check1} \PY{o+ow}{and} \PY{n}{check2} \PY{o+ow}{and} \PY{n+nb}{len}\PY{p}{(}\PY{n}{hband\PYZus{}bad\PYZus{}pixels}\PY{p}{)}\PY{o}{\PYZgt{}}\PY{l+m+mi}{0}\PY{p}{:}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{It worked}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{k}{else}\PY{p}{:}   
    \PY{k}{if} \PY{o+ow}{not} \PY{n}{check1}\PY{p}{:}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Length of the array is wrong}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{k}{if} \PY{o+ow}{not} \PY{n}{check2}\PY{p}{:}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Each bad pixel does not have a pair of coordinates}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{k}{if} \PY{o+ow}{not} \PY{n+nb}{len}\PY{p}{(}\PY{n}{hband\PYZus{}bad\PYZus{}pixels}\PY{p}{)}\PY{o}{\PYZgt{}}\PY{l+m+mi}{0}\PY{p}{:}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{No bad pixels found}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n+nb}{str}\PY{p}{(}\PY{l+m+mi}{100} \PY{o}{*} \PY{n+nb}{len}\PY{p}{(}\PY{n}{hband\PYZus{}bad\PYZus{}pixels}\PY{p}{)}\PY{o}{/}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{prod}\PY{p}{(}\PY{n}{median\PYZus{}hband\PYZus{}flat}\PY{o}{.}\PY{n}{shape}\PY{p}{)}\PY{p}{)}
    \PY{p}{)} \PY{o}{+} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{} o}\PY{l+s+s2}{f the pixels that are bad}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
It worked
6.370830535888672\% of the pixels that are bad
    \end{Verbatim}

    \hypertarget{sky-from-dithered-science-frames}{%
\subsection{Sky From Dithered Science
Frames}\label{sky-from-dithered-science-frames}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{20}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{hband\PYZus{}sky} \PY{o}{=} \PY{n}{get\PYZus{}median\PYZus{}frame}\PY{p}{(}\PY{n}{hband\PYZus{}dict}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sci}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{hband\PYZus{}sky}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{20}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
<matplotlib.colorbar.Colorbar at 0x7f1486d65be0>
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_32_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{21}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{characterize}\PY{p}{(}\PY{n}{hband\PYZus{}sky}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
We now statistically characterize the pixel values in the above image.
The average is 40.01339
The median is 37.75
The standard deviation is 58.46128
The median absolute deviation is 10.378215529539215
A histogram of the pixel value is shown below.
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_33_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{22}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}arr} \PY{o}{=} \PY{p}{[}\PY{n}{x}\PY{o}{\PYZhy{}} \PY{n}{hband\PYZus{}sky} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{hband\PYZus{}dict}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sci}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
\PY{n}{fig}\PY{p}{,} \PY{n}{axs} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{400}\PY{p}{)}
\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}arr}\PY{p}{)}\PY{p}{)}\PY{p}{:}
    \PY{n}{r}\PY{p}{,} \PY{n}{c} \PY{o}{=} \PY{n}{i}\PY{o}{\PYZpc{}}\PY{k}{3}, int(np.floor(i/3))
    \PY{n}{axs}\PY{p}{[}\PY{n}{r}\PY{p}{,} \PY{n}{c}\PY{p}{]}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_34_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    The above images generate are high resolution and thus the star (in
green) can be seen at a different location in each image when zooming
in. We discuss the statistics of each frame below.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{23}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{characterize}\PY{p}{(}\PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}arr}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
We now statistically characterize the pixel values in the above image.
The average is -0.5620558
The median is -0.5
The standard deviation is 6.410283
The median absolute deviation is 2.5945538823848038
A histogram of the pixel value is shown below.
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_36_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{24}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{characterize}\PY{p}{(}\PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}arr}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
We now statistically characterize the pixel values in the above image.
The average is -0.6789353
The median is -0.5
The standard deviation is 6.472998
The median absolute deviation is 2.5945538823848038
A histogram of the pixel value is shown below.
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_37_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{25}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{characterize}\PY{p}{(}\PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}arr}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
We now statistically characterize the pixel values in the above image.
The average is -0.76007295
The median is -0.5
The standard deviation is 6.9145336
The median absolute deviation is 2.5945538823848038
A histogram of the pixel value is shown below.
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_38_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{26}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{characterize}\PY{p}{(}\PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}arr}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
We now statistically characterize the pixel values in the above image.
The average is -1.0612109
The median is -0.75
The standard deviation is 6.7692747
The median absolute deviation is 2.5945538823848038
A histogram of the pixel value is shown below.
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_39_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{27}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{characterize}\PY{p}{(}\PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}arr}\PY{p}{[}\PY{l+m+mi}{4}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
We now statistically characterize the pixel values in the above image.
The average is 3.5838177
The median is 3.75
The standard deviation is 8.234903
The median absolute deviation is 3.706505546264005
A histogram of the pixel value is shown below.
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_40_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{28}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{characterize}\PY{p}{(}\PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}arr}\PY{p}{[}\PY{l+m+mi}{5}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
We now statistically characterize the pixel values in the above image.
The average is -0.62310433
The median is -0.5
The standard deviation is 5.4304338
The median absolute deviation is 2.5945538823848038
A histogram of the pixel value is shown below.
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_41_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{29}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{characterize}\PY{p}{(}\PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}arr}\PY{p}{[}\PY{l+m+mi}{6}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
We now statistically characterize the pixel values in the above image.
The average is 0.3605268
The median is 0.25
The standard deviation is 7.7731915
The median absolute deviation is 2.5945538823848038
A histogram of the pixel value is shown below.
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_42_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{30}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{characterize}\PY{p}{(}\PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}arr}\PY{p}{[}\PY{l+m+mi}{7}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
We now statistically characterize the pixel values in the above image.
The average is 1.0028875
The median is 0.75
The standard deviation is 6.4711423
The median absolute deviation is 2.5945538823848038
A histogram of the pixel value is shown below.
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_43_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{remove-bad-pixels}{%
\subsection{Remove Bad Pixels}\label{remove-bad-pixels}}

We proceed by setting each bad pixel to 0.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{31}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{for} \PY{n}{coord\PYZus{}pair} \PY{o+ow}{in} \PY{n}{hband\PYZus{}bad\PYZus{}pixels}\PY{p}{:}
    \PY{k}{for} \PY{n}{frame\PYZus{}index} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}arr}\PY{p}{)}\PY{p}{)}\PY{p}{:}
        \PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}arr}\PY{p}{[}\PY{n}{frame\PYZus{}index}\PY{p}{]}\PY{p}{[}\PY{n}{coord\PYZus{}pair}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}\PY{p}{[}\PY{n}{coord\PYZus{}pair}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{fig}\PY{p}{,} \PY{n}{axs} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{400}\PY{p}{)}
\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}arr}\PY{p}{)}\PY{p}{)}\PY{p}{:}
    \PY{n}{r}\PY{p}{,} \PY{n}{c} \PY{o}{=} \PY{n}{i}\PY{o}{\PYZpc{}}\PY{k}{3}, int(np.floor(i/3))
    \PY{n}{axs}\PY{p}{[}\PY{n}{r}\PY{p}{,} \PY{n}{c}\PY{p}{]}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_45_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{32}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{characterize}\PY{p}{(}\PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}arr}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
We now statistically characterize the pixel values in the above image.
The average is -0.54964566
The median is -0.25
The standard deviation is 6.0754824
The median absolute deviation is 2.223903327758403
A histogram of the pixel value is shown below.
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_46_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{33}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{characterize}\PY{p}{(}\PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}arr}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
We now statistically characterize the pixel values in the above image.
The average is -0.71281934
The median is -0.5
The standard deviation is 6.12452
The median absolute deviation is 2.5945538823848038
A histogram of the pixel value is shown below.
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_47_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{34}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{characterize}\PY{p}{(}\PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}arr}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
We now statistically characterize the pixel values in the above image.
The average is -0.840739
The median is -0.5
The standard deviation is 6.371697
The median absolute deviation is 2.5945538823848038
A histogram of the pixel value is shown below.
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_48_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{35}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{characterize}\PY{p}{(}\PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}arr}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
We now statistically characterize the pixel values in the above image.
The average is -1.1079857
The median is -0.75
The standard deviation is 6.336597
The median absolute deviation is 2.5945538823848038
A histogram of the pixel value is shown below.
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_49_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{36}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{characterize}\PY{p}{(}\PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}arr}\PY{p}{[}\PY{l+m+mi}{4}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
We now statistically characterize the pixel values in the above image.
The average is 3.786525
The median is 3.5
The standard deviation is 6.690043
The median absolute deviation is 4.077156100890406
A histogram of the pixel value is shown below.
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_50_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{37}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{characterize}\PY{p}{(}\PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}arr}\PY{p}{[}\PY{l+m+mi}{5}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
We now statistically characterize the pixel values in the above image.
The average is -0.716789
The median is -0.25
The standard deviation is 4.5266557
The median absolute deviation is 2.5945538823848038
A histogram of the pixel value is shown below.
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_51_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{38}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{characterize}\PY{p}{(}\PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}arr}\PY{p}{[}\PY{l+m+mi}{6}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
We now statistically characterize the pixel values in the above image.
The average is 0.3910911
The median is 0.0
The standard deviation is 7.435571
The median absolute deviation is 2.223903327758403
A histogram of the pixel value is shown below.
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_52_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{39}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{characterize}\PY{p}{(}\PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}arr}\PY{p}{[}\PY{l+m+mi}{7}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
We now statistically characterize the pixel values in the above image.
The average is 1.0977561
The median is 0.5
The standard deviation is 5.7013655
The median absolute deviation is 2.5945538823848038
A histogram of the pixel value is shown below.
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_53_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    As seen, there is a small cluster of pixels with a pixel value of
approximately 200 and a few points with a pixel value around 400. These
are likely the star and the planet.

    \hypertarget{find-the-local-maxima-in-each-sky-subtracted-frame.}{%
\subsubsection{Find the local maxima in each sky subtracted
frame.}\label{find-the-local-maxima-in-each-sky-subtracted-frame.}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{40}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}dicts} \PY{o}{=} \PY{p}{[}\PY{n}{characterize}\PY{p}{(}\PY{n}{frame}\PY{p}{,} \PY{k+kc}{True}\PY{p}{)} \PY{k}{for} \PY{n}{frame} \PY{o+ow}{in} \PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}arr}\PY{p}{]}
\PY{n}{bkg\PYZus{}sigma} \PY{o}{=} \PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}dicts}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{median absolute deviation}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
\PY{n}{filter\PYZus{}fwhm} \PY{o}{=} \PY{l+m+mi}{206265}\PY{o}{*}\PY{l+m+mf}{1630.0}\PY{o}{*}\PY{l+m+mf}{1.0e\PYZhy{}9}\PY{o}{/}\PY{l+m+mf}{8.2} \PY{o}{/} \PY{l+m+mf}{0.012}
\PY{n}{daofind} \PY{o}{=} \PY{n}{DAOStarFinder}\PY{p}{(}\PY{n}{fwhm} \PY{o}{=} \PY{n}{filter\PYZus{}fwhm}\PY{p}{,} \PY{n}{threshold} \PY{o}{=} \PY{l+m+mf}{100.0}\PY{o}{*}\PY{n}{bkg\PYZus{}sigma}\PY{p}{)}
\PY{n}{final\PYZus{}image\PYZus{}cropped} \PY{o}{=} \PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}arr}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\PY{n}{sources} \PY{o}{=} \PY{n}{daofind}\PY{p}{(}\PY{n}{final\PYZus{}image\PYZus{}cropped}\PY{p}{)}
\PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{sources}\PY{o}{.}\PY{n}{colnames}\PY{p}{:}
    \PY{n}{sources}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{info}\PY{o}{.}\PY{n}{format} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.8g}\PY{l+s+s1}{\PYZsq{}}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{sources}\PY{p}{)}
\PY{n}{positions} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{(}\PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xcentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ycentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
\PY{n}{star\PYZus{}position\PYZus{}arr} \PY{o}{=} \PY{p}{[}\PY{p}{[}\PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xcentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ycentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{]}
\PY{n}{apertures} \PY{o}{=} \PY{n}{CircularAperture}\PY{p}{(}\PY{n}{positions}\PY{p}{,} \PY{n}{r}\PY{o}{=}\PY{n}{filter\PYZus{}fwhm}\PY{p}{)}
\PY{n}{phot\PYZus{}table} \PY{o}{=} \PY{n}{aperture\PYZus{}photometry}\PY{p}{(}\PY{n}{final\PYZus{}image\PYZus{}cropped}\PY{p}{,} \PY{n}{apertures}\PY{p}{)}
\PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{phot\PYZus{}table}\PY{o}{.}\PY{n}{colnames}\PY{p}{:}
    \PY{n}{phot\PYZus{}table}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{info}\PY{o}{.}\PY{n}{format} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.8g}\PY{l+s+s1}{\PYZsq{}}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{phot\PYZus{}table}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{final\PYZus{}image\PYZus{}cropped}\PY{p}{,}\PY{n}{vmin}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{vmax}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{hot}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{p}{)}
\PY{n}{apertures}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cyan}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mi}{5}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.75}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
 id xcentroid ycentroid sharpness  {\ldots} sky   peak     flux      mag
--- --------- --------- ---------- {\ldots} --- ------- --------- ----------
  1 489.13593 406.69574 0.42665548 {\ldots}   0 2036.75 6.8618793 -2.0911077
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 489.13593 406.69574    24936.023
    \end{Verbatim}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{40}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
[<matplotlib.patches.Circle at 0x7f14867473d0>]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_56_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{41}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{i} \PY{o}{=} \PY{l+m+mi}{1}
\PY{n}{bkg\PYZus{}sigma} \PY{o}{=} \PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}dicts}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{median absolute deviation}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
\PY{n}{filter\PYZus{}fwhm} \PY{o}{=} \PY{l+m+mi}{206265}\PY{o}{*}\PY{l+m+mf}{1630.0}\PY{o}{*}\PY{l+m+mf}{1.0e\PYZhy{}9}\PY{o}{/}\PY{l+m+mf}{8.2} \PY{o}{/} \PY{l+m+mf}{0.012}
\PY{n}{daofind} \PY{o}{=} \PY{n}{DAOStarFinder}\PY{p}{(}\PY{n}{fwhm} \PY{o}{=} \PY{n}{filter\PYZus{}fwhm}\PY{p}{,} \PY{n}{threshold} \PY{o}{=} \PY{l+m+mf}{100.0}\PY{o}{*}\PY{n}{bkg\PYZus{}sigma}\PY{p}{)}
\PY{n}{final\PYZus{}image\PYZus{}cropped} \PY{o}{=} \PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]}
\PY{n}{sources} \PY{o}{=} \PY{n}{daofind}\PY{p}{(}\PY{n}{final\PYZus{}image\PYZus{}cropped}\PY{p}{)}
\PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{sources}\PY{o}{.}\PY{n}{colnames}\PY{p}{:}
    \PY{n}{sources}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{info}\PY{o}{.}\PY{n}{format} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.8g}\PY{l+s+s1}{\PYZsq{}}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{sources}\PY{p}{)}
\PY{n}{positions} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{(}\PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xcentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ycentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
\PY{n}{star\PYZus{}position\PYZus{}arr}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xcentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ycentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}
\PY{n}{apertures} \PY{o}{=} \PY{n}{CircularAperture}\PY{p}{(}\PY{n}{positions}\PY{p}{,} \PY{n}{r}\PY{o}{=}\PY{n}{filter\PYZus{}fwhm}\PY{p}{)}
\PY{n}{phot\PYZus{}table} \PY{o}{=} \PY{n}{aperture\PYZus{}photometry}\PY{p}{(}\PY{n}{final\PYZus{}image\PYZus{}cropped}\PY{p}{,} \PY{n}{apertures}\PY{p}{)}
\PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{phot\PYZus{}table}\PY{o}{.}\PY{n}{colnames}\PY{p}{:}
    \PY{n}{phot\PYZus{}table}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{info}\PY{o}{.}\PY{n}{format} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.8g}\PY{l+s+s1}{\PYZsq{}}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{phot\PYZus{}table}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{final\PYZus{}image\PYZus{}cropped}\PY{p}{,}\PY{n}{vmin}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{vmax}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{hot}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{p}{)}
\PY{n}{apertures}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cyan}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mi}{5}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.75}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
 id xcentroid ycentroid sharpness  {\ldots} sky peak    flux      mag
--- --------- --------- ---------- {\ldots} --- ---- --------- ----------
  1 579.85625  596.2173 0.47873497 {\ldots}   0 2241 6.5297203 -2.0372364
 id  xcenter  ycenter  aperture\_sum
       pix      pix
--- --------- -------- ------------
  1 579.85625 596.2173    23471.279
    \end{Verbatim}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{41}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
[<matplotlib.patches.Circle at 0x7f14c1fc1100>]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_57_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{42}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{i} \PY{o}{=} \PY{l+m+mi}{2}
\PY{n}{bkg\PYZus{}sigma} \PY{o}{=} \PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}dicts}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{median absolute deviation}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
\PY{n}{filter\PYZus{}fwhm} \PY{o}{=} \PY{l+m+mi}{206265}\PY{o}{*}\PY{l+m+mf}{1630.0}\PY{o}{*}\PY{l+m+mf}{1.0e\PYZhy{}9}\PY{o}{/}\PY{l+m+mf}{8.2} \PY{o}{/} \PY{l+m+mf}{0.012}
\PY{n}{daofind} \PY{o}{=} \PY{n}{DAOStarFinder}\PY{p}{(}\PY{n}{fwhm} \PY{o}{=} \PY{n}{filter\PYZus{}fwhm}\PY{p}{,} \PY{n}{threshold} \PY{o}{=} \PY{l+m+mf}{200.0}\PY{o}{*}\PY{n}{bkg\PYZus{}sigma}\PY{p}{)}
\PY{n}{final\PYZus{}image\PYZus{}cropped} \PY{o}{=} \PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]}
\PY{n}{sources} \PY{o}{=} \PY{n}{daofind}\PY{p}{(}\PY{n}{final\PYZus{}image\PYZus{}cropped}\PY{p}{)}
\PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{sources}\PY{o}{.}\PY{n}{colnames}\PY{p}{:}
    \PY{n}{sources}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{info}\PY{o}{.}\PY{n}{format} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.8g}\PY{l+s+s1}{\PYZsq{}}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{sources}\PY{p}{)}
\PY{n}{positions} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{(}\PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xcentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ycentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
\PY{n}{star\PYZus{}position\PYZus{}arr}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xcentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ycentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}
\PY{n}{apertures} \PY{o}{=} \PY{n}{CircularAperture}\PY{p}{(}\PY{n}{positions}\PY{p}{,} \PY{n}{r}\PY{o}{=}\PY{n}{filter\PYZus{}fwhm}\PY{p}{)}
\PY{n}{phot\PYZus{}table} \PY{o}{=} \PY{n}{aperture\PYZus{}photometry}\PY{p}{(}\PY{n}{final\PYZus{}image\PYZus{}cropped}\PY{p}{,} \PY{n}{apertures}\PY{p}{)}
\PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{phot\PYZus{}table}\PY{o}{.}\PY{n}{colnames}\PY{p}{:}
    \PY{n}{phot\PYZus{}table}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{info}\PY{o}{.}\PY{n}{format} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.8g}\PY{l+s+s1}{\PYZsq{}}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{phot\PYZus{}table}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{final\PYZus{}image\PYZus{}cropped}\PY{p}{,}\PY{n}{vmin}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{vmax}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{hot}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{p}{)}
\PY{n}{apertures}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cyan}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mi}{5}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.75}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
 id xcentroid ycentroid sharpness  {\ldots} sky  peak     flux      mag
--- --------- --------- ---------- {\ldots} --- ------ --------- ----------
  1 395.12312  606.7785 0.49097021 {\ldots}   0 2344.5 3.2649455 -1.2846898
 id  xcenter  ycenter  aperture\_sum
       pix      pix
--- --------- -------- ------------
  1 395.12312 606.7785    25456.176
    \end{Verbatim}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{42}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
[<matplotlib.patches.Circle at 0x7f14878b7ca0>]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_58_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{43}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{i} \PY{o}{=} \PY{l+m+mi}{3}
\PY{n}{bkg\PYZus{}sigma} \PY{o}{=} \PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}dicts}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{median absolute deviation}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
\PY{n}{filter\PYZus{}fwhm} \PY{o}{=} \PY{l+m+mi}{206265}\PY{o}{*}\PY{l+m+mf}{1630.0}\PY{o}{*}\PY{l+m+mf}{1.0e\PYZhy{}9}\PY{o}{/}\PY{l+m+mf}{8.2} \PY{o}{/} \PY{l+m+mf}{0.012}
\PY{n}{daofind} \PY{o}{=} \PY{n}{DAOStarFinder}\PY{p}{(}\PY{n}{fwhm} \PY{o}{=} \PY{n}{filter\PYZus{}fwhm}\PY{p}{,} \PY{n}{threshold} \PY{o}{=} \PY{l+m+mf}{200.0}\PY{o}{*}\PY{n}{bkg\PYZus{}sigma}\PY{p}{)}
\PY{n}{final\PYZus{}image\PYZus{}cropped} \PY{o}{=} \PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]}
\PY{n}{sources} \PY{o}{=} \PY{n}{daofind}\PY{p}{(}\PY{n}{final\PYZus{}image\PYZus{}cropped}\PY{p}{)}
\PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{sources}\PY{o}{.}\PY{n}{colnames}\PY{p}{:}
    \PY{n}{sources}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{info}\PY{o}{.}\PY{n}{format} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.8g}\PY{l+s+s1}{\PYZsq{}}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{sources}\PY{p}{)}
\PY{n}{positions} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{(}\PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xcentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ycentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
\PY{n}{star\PYZus{}position\PYZus{}arr}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xcentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ycentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}
\PY{n}{apertures} \PY{o}{=} \PY{n}{CircularAperture}\PY{p}{(}\PY{n}{positions}\PY{p}{,} \PY{n}{r}\PY{o}{=}\PY{n}{filter\PYZus{}fwhm}\PY{p}{)}
\PY{n}{phot\PYZus{}table} \PY{o}{=} \PY{n}{aperture\PYZus{}photometry}\PY{p}{(}\PY{n}{final\PYZus{}image\PYZus{}cropped}\PY{p}{,} \PY{n}{apertures}\PY{p}{)}
\PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{phot\PYZus{}table}\PY{o}{.}\PY{n}{colnames}\PY{p}{:}
    \PY{n}{phot\PYZus{}table}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{info}\PY{o}{.}\PY{n}{format} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.8g}\PY{l+s+s1}{\PYZsq{}}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{phot\PYZus{}table}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{final\PYZus{}image\PYZus{}cropped}\PY{p}{,}\PY{n}{vmin}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{vmax}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{hot}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{p}{)}
\PY{n}{apertures}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cyan}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mi}{5}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.75}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
 id xcentroid ycentroid sharpness  {\ldots} sky   peak     flux      mag
--- --------- --------- ---------- {\ldots} --- ------- --------- ----------
  1 364.38537 403.94075 0.46546806 {\ldots}   0 2182.75 3.0630536 -1.2153865
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 364.38537 403.94075     25087.29
    \end{Verbatim}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{43}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
[<matplotlib.patches.Circle at 0x7f1488f6e3d0>]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_59_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{44}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{i} \PY{o}{=} \PY{l+m+mi}{4}
\PY{n}{bkg\PYZus{}sigma} \PY{o}{=} \PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}dicts}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{median absolute deviation}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
\PY{n}{filter\PYZus{}fwhm} \PY{o}{=} \PY{l+m+mi}{206265}\PY{o}{*}\PY{l+m+mf}{1630.0}\PY{o}{*}\PY{l+m+mf}{1.0e\PYZhy{}9}\PY{o}{/}\PY{l+m+mf}{8.2} \PY{o}{/} \PY{l+m+mf}{0.012}
\PY{n}{daofind} \PY{o}{=} \PY{n}{DAOStarFinder}\PY{p}{(}\PY{n}{fwhm} \PY{o}{=} \PY{n}{filter\PYZus{}fwhm}\PY{p}{,} \PY{n}{threshold} \PY{o}{=} \PY{l+m+mf}{200.0}\PY{o}{*}\PY{n}{bkg\PYZus{}sigma}\PY{p}{)}
\PY{n}{final\PYZus{}image\PYZus{}cropped} \PY{o}{=} \PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]}
\PY{n}{sources} \PY{o}{=} \PY{n}{daofind}\PY{p}{(}\PY{n}{final\PYZus{}image\PYZus{}cropped}\PY{p}{)}
\PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{sources}\PY{o}{.}\PY{n}{colnames}\PY{p}{:}
    \PY{n}{sources}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{info}\PY{o}{.}\PY{n}{format} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.8g}\PY{l+s+s1}{\PYZsq{}}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{sources}\PY{p}{)}
\PY{n}{positions} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{(}\PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xcentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ycentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
\PY{n}{star\PYZus{}position\PYZus{}arr}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xcentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ycentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}
\PY{n}{apertures} \PY{o}{=} \PY{n}{CircularAperture}\PY{p}{(}\PY{n}{positions}\PY{p}{,} \PY{n}{r}\PY{o}{=}\PY{n}{filter\PYZus{}fwhm}\PY{p}{)}
\PY{n}{phot\PYZus{}table} \PY{o}{=} \PY{n}{aperture\PYZus{}photometry}\PY{p}{(}\PY{n}{final\PYZus{}image\PYZus{}cropped}\PY{p}{,} \PY{n}{apertures}\PY{p}{)}
\PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{phot\PYZus{}table}\PY{o}{.}\PY{n}{colnames}\PY{p}{:}
    \PY{n}{phot\PYZus{}table}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{info}\PY{o}{.}\PY{n}{format} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.8g}\PY{l+s+s1}{\PYZsq{}}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{phot\PYZus{}table}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{final\PYZus{}image\PYZus{}cropped}\PY{p}{,}\PY{n}{vmin}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{vmax}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{hot}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{p}{)}
\PY{n}{apertures}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cyan}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mi}{5}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.75}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
 id xcentroid ycentroid sharpness  {\ldots} sky peak    flux       mag
--- --------- --------- ---------- {\ldots} --- ---- --------- -----------
  1 580.28154 596.29025 0.46555422 {\ldots}   0 2273 2.0582883 -0.78376553
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 580.28154 596.29025    25454.419
    \end{Verbatim}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{44}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
[<matplotlib.patches.Circle at 0x7f1487752af0>]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_60_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{45}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{i} \PY{o}{=} \PY{l+m+mi}{5}
\PY{n}{bkg\PYZus{}sigma} \PY{o}{=} \PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}dicts}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{median absolute deviation}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
\PY{n}{filter\PYZus{}fwhm} \PY{o}{=} \PY{l+m+mi}{206265}\PY{o}{*}\PY{l+m+mf}{1630.0}\PY{o}{*}\PY{l+m+mf}{1.0e\PYZhy{}9}\PY{o}{/}\PY{l+m+mf}{8.2} \PY{o}{/} \PY{l+m+mf}{0.012}
\PY{n}{daofind} \PY{o}{=} \PY{n}{DAOStarFinder}\PY{p}{(}\PY{n}{fwhm} \PY{o}{=} \PY{n}{filter\PYZus{}fwhm}\PY{p}{,} \PY{n}{threshold} \PY{o}{=} \PY{l+m+mf}{200.0}\PY{o}{*}\PY{n}{bkg\PYZus{}sigma}\PY{p}{)}
\PY{n}{final\PYZus{}image\PYZus{}cropped} \PY{o}{=} \PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]}
\PY{n}{sources} \PY{o}{=} \PY{n}{daofind}\PY{p}{(}\PY{n}{final\PYZus{}image\PYZus{}cropped}\PY{p}{)}
\PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{sources}\PY{o}{.}\PY{n}{colnames}\PY{p}{:}
    \PY{n}{sources}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{info}\PY{o}{.}\PY{n}{format} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.8g}\PY{l+s+s1}{\PYZsq{}}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{sources}\PY{p}{)}
\PY{n}{positions} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{(}\PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xcentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ycentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
\PY{n}{star\PYZus{}position\PYZus{}arr}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xcentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ycentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}
\PY{n}{apertures} \PY{o}{=} \PY{n}{CircularAperture}\PY{p}{(}\PY{n}{positions}\PY{p}{,} \PY{n}{r}\PY{o}{=}\PY{n}{filter\PYZus{}fwhm}\PY{p}{)}
\PY{n}{phot\PYZus{}table} \PY{o}{=} \PY{n}{aperture\PYZus{}photometry}\PY{p}{(}\PY{n}{final\PYZus{}image\PYZus{}cropped}\PY{p}{,} \PY{n}{apertures}\PY{p}{)}
\PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{phot\PYZus{}table}\PY{o}{.}\PY{n}{colnames}\PY{p}{:}
    \PY{n}{phot\PYZus{}table}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{info}\PY{o}{.}\PY{n}{format} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.8g}\PY{l+s+s1}{\PYZsq{}}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{phot\PYZus{}table}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{final\PYZus{}image\PYZus{}cropped}\PY{p}{,}\PY{n}{vmin}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{vmax}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{hot}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{p}{)}
\PY{n}{apertures}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cyan}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mi}{5}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.75}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
 id xcentroid ycentroid sharpness  {\ldots} sky peak    flux       mag
--- --------- --------- ---------- {\ldots} --- ---- --------- -----------
  1 735.55183 411.67456 0.37563408 {\ldots}   0 1140 1.7748492 -0.62290363
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 735.55183 411.67456     14408.87
    \end{Verbatim}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{45}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
[<matplotlib.patches.Circle at 0x7f14868261c0>]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_61_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{46}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{i} \PY{o}{=} \PY{l+m+mi}{6}
\PY{n}{bkg\PYZus{}sigma} \PY{o}{=} \PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}dicts}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{median absolute deviation}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
\PY{n}{filter\PYZus{}fwhm} \PY{o}{=} \PY{l+m+mi}{206265}\PY{o}{*}\PY{l+m+mf}{1630.0}\PY{o}{*}\PY{l+m+mf}{1.0e\PYZhy{}9}\PY{o}{/}\PY{l+m+mf}{8.2} \PY{o}{/} \PY{l+m+mf}{0.012}
\PY{n}{daofind} \PY{o}{=} \PY{n}{DAOStarFinder}\PY{p}{(}\PY{n}{fwhm} \PY{o}{=} \PY{n}{filter\PYZus{}fwhm}\PY{p}{,} \PY{n}{threshold} \PY{o}{=} \PY{l+m+mf}{200.0}\PY{o}{*}\PY{n}{bkg\PYZus{}sigma}\PY{p}{)}
\PY{n}{final\PYZus{}image\PYZus{}cropped} \PY{o}{=} \PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]}
\PY{n}{sources} \PY{o}{=} \PY{n}{daofind}\PY{p}{(}\PY{n}{final\PYZus{}image\PYZus{}cropped}\PY{p}{)}
\PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{sources}\PY{o}{.}\PY{n}{colnames}\PY{p}{:}
    \PY{n}{sources}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{info}\PY{o}{.}\PY{n}{format} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.8g}\PY{l+s+s1}{\PYZsq{}}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{sources}\PY{p}{)}
\PY{n}{positions} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{(}\PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xcentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ycentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
\PY{n}{star\PYZus{}position\PYZus{}arr}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xcentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ycentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}
\PY{n}{apertures} \PY{o}{=} \PY{n}{CircularAperture}\PY{p}{(}\PY{n}{positions}\PY{p}{,} \PY{n}{r}\PY{o}{=}\PY{n}{filter\PYZus{}fwhm}\PY{p}{)}
\PY{n}{phot\PYZus{}table} \PY{o}{=} \PY{n}{aperture\PYZus{}photometry}\PY{p}{(}\PY{n}{final\PYZus{}image\PYZus{}cropped}\PY{p}{,} \PY{n}{apertures}\PY{p}{)}
\PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{phot\PYZus{}table}\PY{o}{.}\PY{n}{colnames}\PY{p}{:}
    \PY{n}{phot\PYZus{}table}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{info}\PY{o}{.}\PY{n}{format} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.8g}\PY{l+s+s1}{\PYZsq{}}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{phot\PYZus{}table}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{final\PYZus{}image\PYZus{}cropped}\PY{p}{,}\PY{n}{vmin}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{vmax}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{hot}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{p}{)}
\PY{n}{apertures}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cyan}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mi}{5}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.75}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
 id xcentroid ycentroid sharpness  {\ldots} sky   peak     flux      mag
--- --------- --------- ---------- {\ldots} --- ------- --------- ----------
  1 372.90814 608.77075 0.45686155 {\ldots}   0 3017.25 5.3046885 -1.8116497
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 372.90814 608.77075    31446.751
    \end{Verbatim}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{46}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
[<matplotlib.patches.Circle at 0x7f14bd954910>]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_62_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{47}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{i} \PY{o}{=} \PY{l+m+mi}{7}
\PY{n}{bkg\PYZus{}sigma} \PY{o}{=} \PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}dicts}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{median absolute deviation}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
\PY{n}{filter\PYZus{}fwhm} \PY{o}{=} \PY{l+m+mi}{206265}\PY{o}{*}\PY{l+m+mf}{1630.0}\PY{o}{*}\PY{l+m+mf}{1.0e\PYZhy{}9}\PY{o}{/}\PY{l+m+mf}{8.2} \PY{o}{/} \PY{l+m+mf}{0.012}
\PY{n}{daofind} \PY{o}{=} \PY{n}{DAOStarFinder}\PY{p}{(}\PY{n}{fwhm} \PY{o}{=} \PY{n}{filter\PYZus{}fwhm}\PY{p}{,} \PY{n}{threshold} \PY{o}{=} \PY{l+m+mf}{200.0}\PY{o}{*}\PY{n}{bkg\PYZus{}sigma}\PY{p}{)}
\PY{n}{final\PYZus{}image\PYZus{}cropped} \PY{o}{=} \PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]}
\PY{n}{sources} \PY{o}{=} \PY{n}{daofind}\PY{p}{(}\PY{n}{final\PYZus{}image\PYZus{}cropped}\PY{p}{)}
\PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{sources}\PY{o}{.}\PY{n}{colnames}\PY{p}{:}
    \PY{n}{sources}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{info}\PY{o}{.}\PY{n}{format} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.8g}\PY{l+s+s1}{\PYZsq{}}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{sources}\PY{p}{)}
\PY{n}{positions} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{(}\PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xcentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ycentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
\PY{n}{star\PYZus{}position\PYZus{}arr}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xcentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ycentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}
\PY{n}{apertures} \PY{o}{=} \PY{n}{CircularAperture}\PY{p}{(}\PY{n}{positions}\PY{p}{,} \PY{n}{r}\PY{o}{=}\PY{n}{filter\PYZus{}fwhm}\PY{p}{)}
\PY{n}{phot\PYZus{}table} \PY{o}{=} \PY{n}{aperture\PYZus{}photometry}\PY{p}{(}\PY{n}{final\PYZus{}image\PYZus{}cropped}\PY{p}{,} \PY{n}{apertures}\PY{p}{)}
\PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{phot\PYZus{}table}\PY{o}{.}\PY{n}{colnames}\PY{p}{:}
    \PY{n}{phot\PYZus{}table}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{info}\PY{o}{.}\PY{n}{format} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.8g}\PY{l+s+s1}{\PYZsq{}}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{phot\PYZus{}table}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{final\PYZus{}image\PYZus{}cropped}\PY{p}{,}\PY{n}{vmin}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{vmax}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{hot}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{p}{)}
\PY{n}{apertures}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cyan}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw} \PY{o}{=} \PY{l+m+mi}{5}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{l+m+mf}{0.75}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
 id xcentroid ycentroid sharpness  roundness1 {\ldots} sky peak   flux       mag
--- --------- --------- ---------- ---------- {\ldots} --- ---- -------- -----------
  1 752.19986 721.32025 0.48655757 0.16048379 {\ldots}   0 1900 2.508955 -0.99873218
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 752.19986 721.32025    22894.986
    \end{Verbatim}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{47}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
[<matplotlib.patches.Circle at 0x7f14bdadc040>]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_63_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{48}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{centered\PYZus{}frames} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}dfs} \PY{o}{=} \PY{p}{[}\PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{x}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}arr}\PY{p}{]}
\PY{n}{star\PYZus{}x\PYZus{}arr} \PY{o}{=} \PY{p}{[}\PY{n+nb}{int}\PY{p}{(}\PY{n}{star\PYZus{}position}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{star\PYZus{}position} \PY{o+ow}{in} \PY{n}{star\PYZus{}position\PYZus{}arr}\PY{p}{]}
\PY{n}{star\PYZus{}y\PYZus{}arr} \PY{o}{=} \PY{p}{[}\PY{n+nb}{int}\PY{p}{(}\PY{n}{star\PYZus{}position}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{star\PYZus{}position} \PY{o+ow}{in} \PY{n}{star\PYZus{}position\PYZus{}arr}\PY{p}{]}
\PY{c+c1}{\PYZsh{}size = min(min(star\PYZus{}x\PYZus{}arr), no\PYZus{}sky\PYZus{}hband\PYZus{}dfs[0].shape[0]\PYZhy{}max(star\PYZus{}x\PYZus{}arr),}
\PY{c+c1}{\PYZsh{}           min(star\PYZus{}y\PYZus{}arr), no\PYZus{}sky\PYZus{}hband\PYZus{}dfs[0].shape[1]\PYZhy{}min(star\PYZus{}y\PYZus{}arr))\PYZhy{}1}
\PY{c+c1}{\PYZsh{}print(\PYZdq{}maximum frame size: \PYZdq{} + str(size))}
\PY{n}{top\PYZus{}left} \PY{o}{=} \PY{l+m+mi}{300}
\PY{n}{centered\PYZus{}frames} \PY{o}{=} \PY{p}{[}\PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}dfs}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{star\PYZus{}y\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{top\PYZus{}left} \PY{p}{:} \PY{n}{star\PYZus{}y\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{+} \PY{l+m+mi}{50} \PY{p}{,} 
                \PY{n}{star\PYZus{}x\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{\PYZhy{}} \PY{n}{top\PYZus{}left} \PY{p}{:} \PY{n}{star\PYZus{}x\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{+} \PY{l+m+mi}{50}\PY{p}{]} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{star\PYZus{}y\PYZus{}arr}\PY{p}{)}\PY{p}{)} \PY{p}{]}
\PY{n}{fig}\PY{p}{,} \PY{n}{axs} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{400}\PY{p}{)}
\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}arr}\PY{p}{)}\PY{p}{)}\PY{p}{:}
    \PY{n}{r}\PY{p}{,} \PY{n}{c} \PY{o}{=} \PY{n}{i}\PY{o}{\PYZpc{}}\PY{k}{3}, int(np.floor(i/3))
    \PY{n}{axs}\PY{p}{[}\PY{n}{r}\PY{p}{,} \PY{n}{c}\PY{p}{]}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{centered\PYZus{}frames}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_64_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{49}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{median\PYZus{}no\PYZus{}sky\PYZus{}hband} \PY{o}{=} \PY{n}{centered\PYZus{}frames}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\PY{k}{for} \PY{n}{row} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{median\PYZus{}no\PYZus{}sky\PYZus{}hband}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
    \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{median\PYZus{}no\PYZus{}sky\PYZus{}hband}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
        \PY{c+c1}{\PYZsh{}print(str(row) + \PYZdq{} \PYZdq{} + str(col))}
        \PY{n}{median\PYZus{}no\PYZus{}sky\PYZus{}hband}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{row}\PY{p}{,} \PY{n}{col}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{median}\PY{p}{(}\PY{p}{[}\PY{n}{frame}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{row}\PY{p}{,} \PY{n}{col}\PY{p}{]} \PY{k}{for} \PY{n}{frame}
                                                       \PY{o+ow}{in} \PY{n}{centered\PYZus{}frames}\PY{p}{]}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{median\PYZus{}no\PYZus{}sky\PYZus{}hband}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{49}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
<matplotlib.colorbar.Colorbar at 0x7f14d2e4e490>
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_65_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{50}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{characterize}\PY{p}{(}\PY{n}{median\PYZus{}no\PYZus{}sky\PYZus{}hband}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
We now statistically characterize the pixel values in the above image.
The average is 0.4777602
The median is 0.0
The standard deviation is 189    1.086183
190    1.113126
191    1.071099
192    0.980640
193    1.082640
         {\ldots}
534    0.997036
535    1.100389
536    1.006308
537    1.016755
538    8.127584
Length: 350, dtype: float32
The median absolute deviation is 0.9266263865660013
A histogram of the pixel value is shown below.
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_66_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{now-to-repeat-the-process-for-the-other-wavelength-bands}{%
\section{Now to repeat the process for the other wavelength
bands}\label{now-to-repeat-the-process-for-the-other-wavelength-bands}}

\hypertarget{jband}{%
\subsection{Jband}\label{jband}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{51}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{jband\PYZus{}sky} \PY{o}{=} \PY{n}{get\PYZus{}median\PYZus{}frame}\PY{p}{(}\PY{n}{jband\PYZus{}dict}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sci}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{jband\PYZus{}sky}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{51}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
<matplotlib.colorbar.Colorbar at 0x7f1484b84d00>
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_68_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{52}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{characterize}\PY{p}{(}\PY{n}{jband\PYZus{}sky}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
We now statistically characterize the pixel values in the above image.
The average is 30.818617
The median is 28.25
The standard deviation is 59.356823
The median absolute deviation is 10.378215529539215
A histogram of the pixel value is shown below.
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_69_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{53}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{no\PYZus{}sky\PYZus{}jband\PYZus{}arr} \PY{o}{=} \PY{p}{[}\PY{n}{x}\PY{o}{\PYZhy{}} \PY{n}{jband\PYZus{}sky} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{jband\PYZus{}dict}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sci}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
\PY{k}{for} \PY{n}{coord\PYZus{}pair} \PY{o+ow}{in} \PY{n}{hband\PYZus{}bad\PYZus{}pixels}\PY{p}{:}
    \PY{k}{for} \PY{n}{frame\PYZus{}index} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{no\PYZus{}sky\PYZus{}jband\PYZus{}arr}\PY{p}{)}\PY{p}{)}\PY{p}{:}
        \PY{n}{no\PYZus{}sky\PYZus{}jband\PYZus{}arr}\PY{p}{[}\PY{n}{frame\PYZus{}index}\PY{p}{]}\PY{p}{[}\PY{n}{coord\PYZus{}pair}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}\PY{p}{[}\PY{n}{coord\PYZus{}pair}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{no\PYZus{}sky\PYZus{}jband\PYZus{}dicts} \PY{o}{=} \PY{p}{[}\PY{n}{characterize}\PY{p}{(}\PY{n}{frame}\PY{p}{,} \PY{k+kc}{True}\PY{p}{)} \PY{k}{for} \PY{n}{frame} \PY{o+ow}{in} \PY{n}{no\PYZus{}sky\PYZus{}jband\PYZus{}arr}\PY{p}{]}
\PY{n}{fig}\PY{p}{,} \PY{n}{axs} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{400}\PY{p}{)}
\PY{n}{jstar\PYZus{}positions} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{no\PYZus{}sky\PYZus{}jband\PYZus{}arr}\PY{p}{)}\PY{p}{)}\PY{p}{:}
    \PY{n}{final\PYZus{}image\PYZus{}cropped} \PY{o}{=} \PY{n}{no\PYZus{}sky\PYZus{}jband\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]}
    \PY{n}{bkg\PYZus{}sigma} \PY{o}{=} \PY{n}{no\PYZus{}sky\PYZus{}jband\PYZus{}dicts}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{median absolute deviation}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
    \PY{n}{filter\PYZus{}fwhm} \PY{o}{=} \PY{l+m+mi}{206265}\PY{o}{*}\PY{l+m+mf}{1630.0}\PY{o}{*}\PY{l+m+mf}{1.0e\PYZhy{}9}\PY{o}{/}\PY{l+m+mf}{8.2} \PY{o}{/} \PY{l+m+mf}{0.012}
    \PY{n}{coeffs} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{2000}\PY{p}{]}
    \PY{n}{max\PYZus{}tries} \PY{o}{=} \PY{l+m+mi}{10}
    \PY{n}{tries} \PY{o}{=} \PY{l+m+mi}{1}
    \PY{n}{coeff} \PY{o}{=} \PY{p}{(}\PY{n}{coeffs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{+} \PY{n}{coeffs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)} \PY{o}{/} \PY{l+m+mi}{2}
    \PY{n}{daofind} \PY{o}{=} \PY{n}{DAOStarFinder}\PY{p}{(}\PY{n}{fwhm} \PY{o}{=} \PY{n}{filter\PYZus{}fwhm}\PY{p}{,} \PY{n}{threshold} \PY{o}{=} \PY{n}{coeff}\PY{o}{*}\PY{n}{bkg\PYZus{}sigma}\PY{p}{)}
    \PY{n}{sources} \PY{o}{=} \PY{n}{daofind}\PY{p}{(}\PY{n}{final\PYZus{}image\PYZus{}cropped}\PY{p}{)}
    \PY{k}{while} \PY{p}{(}\PY{n}{sources} \PY{o+ow}{is} \PY{k+kc}{None} \PY{o+ow}{or} \PY{n+nb}{len}\PY{p}{(}\PY{n}{sources}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{l+m+mi}{1}\PY{p}{)} \PY{o+ow}{and} \PY{p}{(}\PY{n}{tries} \PY{o}{\PYZlt{}} \PY{n}{max\PYZus{}tries}\PY{p}{)}\PY{p}{:}
        \PY{n}{coeff} \PY{o}{=} \PY{p}{(}\PY{n}{coeffs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{+} \PY{n}{coeffs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)} \PY{o}{/} \PY{l+m+mi}{2}
        \PY{n}{daofind} \PY{o}{=} \PY{n}{DAOStarFinder}\PY{p}{(}\PY{n}{fwhm} \PY{o}{=} \PY{n}{filter\PYZus{}fwhm}\PY{p}{,} \PY{n}{threshold} \PY{o}{=} \PY{n}{coeff}\PY{o}{*}\PY{n}{bkg\PYZus{}sigma}\PY{p}{)}
        \PY{n}{sources} \PY{o}{=} \PY{n}{daofind}\PY{p}{(}\PY{n}{final\PYZus{}image\PYZus{}cropped}\PY{p}{)}
        \PY{n}{tries} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
        \PY{k}{if} \PY{n}{sources} \PY{o+ow}{is} \PY{k+kc}{None}\PY{p}{:}
            \PY{n}{coeffs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{=} \PY{n}{coeff} \PY{c+c1}{\PYZsh{}smaller threshold necessary}
        \PY{k}{else}\PY{p}{:}
            \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n}{sources}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{l+m+mi}{1}\PY{p}{:}
                \PY{n}{coeffs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{=} \PY{n}{coeff} \PY{c+c1}{\PYZsh{}larger threshold necessary}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Threshold is }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{coeff}\PY{p}{)} \PY{o}{+} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ times larger than the median absolute deviation}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{sources}\PY{o}{.}\PY{n}{colnames}\PY{p}{:}
        \PY{n}{sources}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{info}\PY{o}{.}\PY{n}{format} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.8g}\PY{l+s+s1}{\PYZsq{}}
    \PY{n+nb}{print}\PY{p}{(}\PY{n}{sources}\PY{p}{)}
    \PY{n}{positions} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{(}\PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xcentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ycentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
    \PY{n}{jstar\PYZus{}positions}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xcentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ycentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}
    \PY{n}{apertures} \PY{o}{=} \PY{n}{CircularAperture}\PY{p}{(}\PY{n}{positions}\PY{p}{,} \PY{n}{r}\PY{o}{=}\PY{n}{filter\PYZus{}fwhm}\PY{p}{)}
    \PY{n}{phot\PYZus{}table} \PY{o}{=} \PY{n}{aperture\PYZus{}photometry}\PY{p}{(}\PY{n}{final\PYZus{}image\PYZus{}cropped}\PY{p}{,} \PY{n}{apertures}\PY{p}{)}
    \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{phot\PYZus{}table}\PY{o}{.}\PY{n}{colnames}\PY{p}{:}
        \PY{n}{phot\PYZus{}table}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{info}\PY{o}{.}\PY{n}{format} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.8g}\PY{l+s+s1}{\PYZsq{}}
    \PY{n+nb}{print}\PY{p}{(}\PY{n}{phot\PYZus{}table}\PY{p}{)}
    \PY{n}{r}\PY{p}{,} \PY{n}{c} \PY{o}{=} \PY{n}{i}\PY{o}{\PYZpc{}}\PY{k}{2}, int(np.floor(i/2))
    \PY{n}{axs}\PY{p}{[}\PY{n}{r}\PY{p}{,} \PY{n}{c}\PY{p}{]}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{final\PYZus{}image\PYZus{}cropped}\PY{p}{,}\PY{n}{vmin}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{vmax}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{hot}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{c+c1}{\PYZsh{}apertures.plot(color = \PYZsq{}cyan\PYZsq{}, lw = 5, alpha = 0.75)}
    \PY{n}{axs}\PY{p}{[}\PY{n}{r}\PY{p}{,}\PY{n}{c}\PY{p}{]}\PY{o}{.}\PY{n}{add\PYZus{}patch}\PY{p}{(}
        \PY{n}{plt}\PY{o}{.}\PY{n}{Circle}\PY{p}{(}\PY{p}{(}\PY{n+nb}{int}\PY{p}{(}\PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xcentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n+nb}{int}\PY{p}{(}\PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ycentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{,} 
                   \PY{l+m+mi}{50}\PY{p}{,} \PY{n}{fill}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{blue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Threshold is 134.375 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky  peak     flux       mag
--- --------- --------- ---------- {\ldots} --- ------ --------- -----------
  1 625.44381 618.88968 0.47513134 {\ldots}   0 764.25 1.5003413 -0.44047516
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 625.44381 618.88968     11994.29
Threshold is 134.375 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky  peak     flux       mag
--- --------- --------- ---------- {\ldots} --- ------ --------- -----------
  1 498.57447 746.02476 0.43226774 {\ldots}   0 717.75 1.3991649 -0.36467227
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 498.57447 746.02476    12045.465
Threshold is 196.5625 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky  peak     flux       mag
--- --------- --------- ---------- {\ldots} --- ------ --------- ------------
  1 792.92817 588.05529 0.50389003 {\ldots}   0 768.25 1.0242023 -0.025964417
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 792.92817 588.05529    11418.825
Threshold is 134.375 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness {\ldots} sky peak    flux       mag
--- --------- --------- --------- {\ldots} --- ---- --------- -----------
  1 479.22822   497.266 0.4765832 {\ldots}   0  836 1.6567839 -0.54816469
 id  xcenter  ycenter aperture\_sum
       pix      pix
--- --------- ------- ------------
  1 479.22822 497.266    12823.399
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_70_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Successfully found the star in each science frame of the Jband.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{54}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{no\PYZus{}sky\PYZus{}jband\PYZus{}dfs} \PY{o}{=} \PY{p}{[}\PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{x}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{no\PYZus{}sky\PYZus{}jband\PYZus{}arr}\PY{p}{]}
\PY{n}{jstar\PYZus{}x\PYZus{}arr} \PY{o}{=} \PY{p}{[}\PY{n+nb}{int}\PY{p}{(}\PY{n}{star\PYZus{}position}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{star\PYZus{}position} \PY{o+ow}{in} \PY{n}{jstar\PYZus{}positions}\PY{p}{]}
\PY{n}{jstar\PYZus{}y\PYZus{}arr} \PY{o}{=} \PY{p}{[}\PY{n+nb}{int}\PY{p}{(}\PY{n}{star\PYZus{}position}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{star\PYZus{}position} \PY{o+ow}{in} \PY{n}{jstar\PYZus{}positions}\PY{p}{]}
\PY{n}{top\PYZus{}left}\PY{p}{,} \PY{n}{bottom\PYZus{}right} \PY{o}{=} \PY{l+m+mi}{300}\PY{p}{,} \PY{l+m+mi}{50}
\PY{n}{jcentered\PYZus{}frames} \PY{o}{=} \PY{p}{[}\PY{n}{no\PYZus{}sky\PYZus{}jband\PYZus{}dfs}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{jstar\PYZus{}y\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{top\PYZus{}left} \PY{p}{:} \PY{n}{jstar\PYZus{}y\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{+} \PY{n}{bottom\PYZus{}right} \PY{p}{,} 
                \PY{n}{jstar\PYZus{}x\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{\PYZhy{}} \PY{n}{top\PYZus{}left} \PY{p}{:} \PY{n}{jstar\PYZus{}x\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{+} \PY{n}{bottom\PYZus{}right}\PY{p}{]} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{jstar\PYZus{}y\PYZus{}arr}\PY{p}{)}\PY{p}{)} \PY{p}{]}
\PY{n}{fig}\PY{p}{,} \PY{n}{axs} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{400}\PY{p}{)}
\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{no\PYZus{}sky\PYZus{}jband\PYZus{}arr}\PY{p}{)}\PY{p}{)}\PY{p}{:}
    \PY{n}{r}\PY{p}{,} \PY{n}{c} \PY{o}{=} \PY{n}{i}\PY{o}{\PYZpc{}}\PY{k}{2}, int(np.floor(i/2))
    \PY{n}{axs}\PY{p}{[}\PY{n}{r}\PY{p}{,} \PY{n}{c}\PY{p}{]}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{jcentered\PYZus{}frames}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_72_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{55}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{median\PYZus{}no\PYZus{}sky\PYZus{}jband} \PY{o}{=} \PY{n}{jcentered\PYZus{}frames}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\PY{k}{for} \PY{n}{row} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{median\PYZus{}no\PYZus{}sky\PYZus{}jband}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
    \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{median\PYZus{}no\PYZus{}sky\PYZus{}jband}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
        \PY{c+c1}{\PYZsh{}print(str(row) + \PYZdq{} \PYZdq{} + str(col))}
        \PY{n}{median\PYZus{}no\PYZus{}sky\PYZus{}jband}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{row}\PY{p}{,} \PY{n}{col}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{median}\PY{p}{(}\PY{p}{[}\PY{n}{frame}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{row}\PY{p}{,} \PY{n}{col}\PY{p}{]} \PY{k}{for} \PY{n}{frame}
                                                       \PY{o+ow}{in} \PY{n}{centered\PYZus{}frames}\PY{p}{]}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{median\PYZus{}no\PYZus{}sky\PYZus{}jband}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{55}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
<matplotlib.colorbar.Colorbar at 0x7f14888319d0>
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_73_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{56}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{characterize}\PY{p}{(}\PY{n}{median\PYZus{}no\PYZus{}sky\PYZus{}jband}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
We now statistically characterize the pixel values in the above image.
The average is 0.5281036
The median is 0.0
The standard deviation is 325    1.103514
326    1.120211
327    1.121228
328    1.010192
329    1.118589
         {\ldots}
670    1.038666
671    1.133211
672    1.103710
673    1.156364
674    2.806221
Length: 350, dtype: float32
The median absolute deviation is 0.9266263865660013
A histogram of the pixel value is shown below.
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_74_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{kband}{%
\subsection{Kband}\label{kband}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{57}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{kband\PYZus{}sky} \PY{o}{=} \PY{n}{get\PYZus{}median\PYZus{}frame}\PY{p}{(}\PY{n}{kband\PYZus{}dict}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sci}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{kband\PYZus{}sky}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{57}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
<matplotlib.colorbar.Colorbar at 0x7f1481e7df70>
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_76_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{58}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{characterize}\PY{p}{(}\PY{n}{kband\PYZus{}sky}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
We now statistically characterize the pixel values in the above image.
The average is 113.247665
The median is 112.75
The standard deviation is 60.83111
The median absolute deviation is 14.08472107580322
A histogram of the pixel value is shown below.
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_77_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{59}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{no\PYZus{}sky\PYZus{}kband\PYZus{}arr} \PY{o}{=} \PY{p}{[}\PY{n}{x}\PY{o}{\PYZhy{}} \PY{n}{kband\PYZus{}sky} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{kband\PYZus{}dict}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sci}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
\PY{k}{for} \PY{n}{coord\PYZus{}pair} \PY{o+ow}{in} \PY{n}{hband\PYZus{}bad\PYZus{}pixels}\PY{p}{:}
    \PY{k}{for} \PY{n}{frame\PYZus{}index} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{no\PYZus{}sky\PYZus{}kband\PYZus{}arr}\PY{p}{)}\PY{p}{)}\PY{p}{:}
        \PY{n}{no\PYZus{}sky\PYZus{}kband\PYZus{}arr}\PY{p}{[}\PY{n}{frame\PYZus{}index}\PY{p}{]}\PY{p}{[}\PY{n}{coord\PYZus{}pair}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}\PY{p}{[}\PY{n}{coord\PYZus{}pair}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{no\PYZus{}sky\PYZus{}kband\PYZus{}dicts} \PY{o}{=} \PY{p}{[}\PY{n}{characterize}\PY{p}{(}\PY{n}{frame}\PY{p}{,} \PY{k+kc}{True}\PY{p}{)} \PY{k}{for} \PY{n}{frame} \PY{o+ow}{in} \PY{n}{no\PYZus{}sky\PYZus{}kband\PYZus{}arr}\PY{p}{]}
\PY{n}{fig}\PY{p}{,} \PY{n}{axs} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{400}\PY{p}{)}
\PY{n}{kstar\PYZus{}positions} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{no\PYZus{}sky\PYZus{}kband\PYZus{}arr}\PY{p}{)}\PY{p}{)}\PY{p}{:}
    \PY{n}{final\PYZus{}image\PYZus{}cropped} \PY{o}{=} \PY{n}{no\PYZus{}sky\PYZus{}kband\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]}
    \PY{n}{bkg\PYZus{}sigma} \PY{o}{=} \PY{n}{no\PYZus{}sky\PYZus{}kband\PYZus{}dicts}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{median absolute deviation}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
    \PY{n}{filter\PYZus{}fwhm} \PY{o}{=} \PY{l+m+mi}{206265}\PY{o}{*}\PY{l+m+mf}{1630.0}\PY{o}{*}\PY{l+m+mf}{1.0e\PYZhy{}9}\PY{o}{/}\PY{l+m+mf}{8.2} \PY{o}{/} \PY{l+m+mf}{0.012}
    \PY{n}{coeffs} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{1000}\PY{p}{]}
    \PY{n}{max\PYZus{}tries} \PY{o}{=} \PY{l+m+mi}{10}
    \PY{n}{tries} \PY{o}{=} \PY{l+m+mi}{1}
    \PY{n}{coeff} \PY{o}{=} \PY{p}{(}\PY{n}{coeffs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{+} \PY{n}{coeffs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)} \PY{o}{/} \PY{l+m+mi}{2}
    \PY{n}{daofind} \PY{o}{=} \PY{n}{DAOStarFinder}\PY{p}{(}\PY{n}{fwhm} \PY{o}{=} \PY{n}{filter\PYZus{}fwhm}\PY{p}{,} \PY{n}{threshold} \PY{o}{=} \PY{n}{coeff}\PY{o}{*}\PY{n}{bkg\PYZus{}sigma}\PY{p}{)}
    \PY{n}{sources} \PY{o}{=} \PY{n}{daofind}\PY{p}{(}\PY{n}{final\PYZus{}image\PYZus{}cropped}\PY{p}{)}
    \PY{k}{while} \PY{p}{(}\PY{n}{sources} \PY{o+ow}{is} \PY{k+kc}{None} \PY{o+ow}{or} \PY{n+nb}{len}\PY{p}{(}\PY{n}{sources}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{l+m+mi}{1}\PY{p}{)} \PY{o+ow}{and} \PY{p}{(}\PY{n}{tries} \PY{o}{\PYZlt{}} \PY{n}{max\PYZus{}tries}\PY{p}{)}\PY{p}{:}
        \PY{n}{coeff} \PY{o}{=} \PY{p}{(}\PY{n}{coeffs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{+} \PY{n}{coeffs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)} \PY{o}{/} \PY{l+m+mi}{2}
        \PY{n}{daofind} \PY{o}{=} \PY{n}{DAOStarFinder}\PY{p}{(}\PY{n}{fwhm} \PY{o}{=} \PY{n}{filter\PYZus{}fwhm}\PY{p}{,} \PY{n}{threshold} \PY{o}{=} \PY{n}{coeff}\PY{o}{*}\PY{n}{bkg\PYZus{}sigma}\PY{p}{)}
        \PY{n}{sources} \PY{o}{=} \PY{n}{daofind}\PY{p}{(}\PY{n}{final\PYZus{}image\PYZus{}cropped}\PY{p}{)}
        \PY{n}{tries} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
        \PY{k}{if} \PY{n}{sources} \PY{o+ow}{is} \PY{k+kc}{None}\PY{p}{:}
            \PY{n}{coeffs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{=} \PY{n}{coeff} \PY{c+c1}{\PYZsh{}smaller threshold necessary}
        \PY{k}{else}\PY{p}{:}
            \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n}{sources}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{l+m+mi}{1}\PY{p}{:}
                \PY{n}{coeffs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{=} \PY{n}{coeff} \PY{c+c1}{\PYZsh{}larger threshold necessary}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Threshold is }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{coeff}\PY{p}{)} \PY{o}{+} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ times larger than the median absolute deviation}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{sources}\PY{o}{.}\PY{n}{colnames}\PY{p}{:}
        \PY{n}{sources}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{info}\PY{o}{.}\PY{n}{format} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.8g}\PY{l+s+s1}{\PYZsq{}}
    \PY{n+nb}{print}\PY{p}{(}\PY{n}{sources}\PY{p}{)}
    \PY{n}{positions} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{(}\PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xcentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ycentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
    \PY{n}{kstar\PYZus{}positions}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xcentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ycentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}
    \PY{n}{apertures} \PY{o}{=} \PY{n}{CircularAperture}\PY{p}{(}\PY{n}{positions}\PY{p}{,} \PY{n}{r}\PY{o}{=}\PY{n}{filter\PYZus{}fwhm}\PY{p}{)}
    \PY{n}{phot\PYZus{}table} \PY{o}{=} \PY{n}{aperture\PYZus{}photometry}\PY{p}{(}\PY{n}{final\PYZus{}image\PYZus{}cropped}\PY{p}{,} \PY{n}{apertures}\PY{p}{)}
    \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{phot\PYZus{}table}\PY{o}{.}\PY{n}{colnames}\PY{p}{:}
        \PY{n}{phot\PYZus{}table}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{info}\PY{o}{.}\PY{n}{format} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.8g}\PY{l+s+s1}{\PYZsq{}}
    \PY{n+nb}{print}\PY{p}{(}\PY{n}{phot\PYZus{}table}\PY{p}{)}
    \PY{n}{r}\PY{p}{,} \PY{n}{c} \PY{o}{=} \PY{n}{i}\PY{o}{\PYZpc{}}\PY{k}{3}, int(np.floor(i/3))
    \PY{n}{axs}\PY{p}{[}\PY{n}{r}\PY{p}{,} \PY{n}{c}\PY{p}{]}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{final\PYZus{}image\PYZus{}cropped}\PY{p}{,}\PY{n}{vmin}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{vmax}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{hot}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{c+c1}{\PYZsh{}apertures.plot(color = \PYZsq{}cyan\PYZsq{}, lw = 5, alpha = 0.75)}
    \PY{n}{axs}\PY{p}{[}\PY{n}{r}\PY{p}{,}\PY{n}{c}\PY{p}{]}\PY{o}{.}\PY{n}{add\PYZus{}patch}\PY{p}{(}
        \PY{n}{plt}\PY{o}{.}\PY{n}{Circle}\PY{p}{(}\PY{p}{(}\PY{n+nb}{int}\PY{p}{(}\PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xcentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n+nb}{int}\PY{p}{(}\PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ycentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{50}\PY{p}{,} \PY{n}{fill}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}
                  \PY{n}{edgecolor}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Threshold is 195.625 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky  peak    flux       mag
--- --------- --------- ---------- {\ldots} --- ------ -------- -----------
  1 664.30464 89.493082 0.82113193 {\ldots}   0 988.75 1.097666 -0.10117556
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 664.30464 89.493082    2693.5499
Threshold is 133.75 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky  peak     flux       mag
--- --------- --------- ---------- {\ldots} --- ------ --------- -----------
  1 741.08576 427.78343 0.45966378 {\ldots}   0 745.75 1.2875761 -0.27443225
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 741.08576 427.78343    9095.8501
Threshold is 257.5 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky  peak     flux       mag
--- --------- --------- ---------- {\ldots} --- ------ --------- -----------
  1 483.52353 782.13851 0.45602989 {\ldots}   0 1829.5 1.8039281 -0.64054808
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 483.52353 782.13851    19603.858
Threshold is 257.5 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky   peak     flux      mag
--- --------- --------- ---------- {\ldots} --- ------- --------- ----------
  1 820.68948  598.9248 0.45913445 {\ldots}   0 1661.75 1.8862942 -0.6890236
 id  xcenter  ycenter  aperture\_sum
       pix      pix
--- --------- -------- ------------
  1 820.68948 598.9248    17767.221
Threshold is 133.75 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky  peak    flux       mag
--- --------- --------- ---------- {\ldots} --- ----- --------- -----------
  1  407.1561 438.30934 0.38227499 {\ldots}   0 763.5 1.6040139 -0.51302033
 id xcenter   ycenter  aperture\_sum
      pix       pix
--- -------- --------- ------------
  1 407.1561 438.30934    9816.0508
Threshold is 133.75 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky  peak     flux       mag
--- --------- --------- ---------- {\ldots} --- ------ --------- -----------
  1 778.58425 795.39926 0.42173794 {\ldots}   0 815.25 1.6693442 -0.55636472
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 778.58425 795.39926    10819.292
Threshold is 257.5 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky   peak     flux       mag
--- --------- --------- ---------- {\ldots} --- ------- --------- -----------
  1 620.09874 609.65361 0.43350301 {\ldots}   0 1495.75 1.4731852 -0.42064335
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 620.09874 609.65361    17059.376
Threshold is 257.5 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness {\ldots} sky   peak     flux       mag
--- --------- --------- --------- {\ldots} --- ------- --------- -----------
  1 833.79989 409.93427 0.4551026 {\ldots}   0 1632.25 1.6662034 -0.55432003
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 833.79989 409.93427    16146.367
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_78_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{60}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{no\PYZus{}sky\PYZus{}kband\PYZus{}arr}\PY{p}{,} \PY{n}{kstar\PYZus{}positions} \PY{o}{=} \PY{n}{no\PYZus{}sky\PYZus{}kband\PYZus{}arr}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{]}\PY{p}{,} \PY{n}{kstar\PYZus{}positions}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{]}
\PY{n}{no\PYZus{}sky\PYZus{}kband\PYZus{}dfs} \PY{o}{=} \PY{p}{[}\PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{x}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{no\PYZus{}sky\PYZus{}kband\PYZus{}arr}\PY{p}{]}
\PY{n}{kstar\PYZus{}x\PYZus{}arr} \PY{o}{=} \PY{p}{[}\PY{n+nb}{int}\PY{p}{(}\PY{n}{star\PYZus{}position}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{star\PYZus{}position} \PY{o+ow}{in} \PY{n}{kstar\PYZus{}positions}\PY{p}{]}
\PY{n}{kstar\PYZus{}y\PYZus{}arr} \PY{o}{=} \PY{p}{[}\PY{n+nb}{int}\PY{p}{(}\PY{n}{star\PYZus{}position}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{star\PYZus{}position} \PY{o+ow}{in} \PY{n}{kstar\PYZus{}positions}\PY{p}{]}
\PY{n}{top\PYZus{}left}\PY{p}{,} \PY{n}{bottom\PYZus{}right} \PY{o}{=} \PY{l+m+mi}{400}\PY{p}{,} \PY{l+m+mi}{30}
\PY{n}{kcentered\PYZus{}frames} \PY{o}{=} \PY{p}{[}\PY{n}{no\PYZus{}sky\PYZus{}kband\PYZus{}dfs}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{kstar\PYZus{}y\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{top\PYZus{}left} \PY{p}{:} \PY{n}{kstar\PYZus{}y\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{+} \PY{n}{bottom\PYZus{}right} \PY{p}{,} 
                \PY{n}{kstar\PYZus{}x\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{\PYZhy{}} \PY{n}{top\PYZus{}left} \PY{p}{:} \PY{n}{kstar\PYZus{}x\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{+} \PY{n}{bottom\PYZus{}right}\PY{p}{]} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{kstar\PYZus{}y\PYZus{}arr}\PY{p}{)}\PY{p}{)} \PY{p}{]}
\PY{n}{fig}\PY{p}{,} \PY{n}{axs} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{400}\PY{p}{)}
\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{no\PYZus{}sky\PYZus{}kband\PYZus{}arr}\PY{p}{)}\PY{p}{)}\PY{p}{:}
    \PY{n}{r}\PY{p}{,} \PY{n}{c} \PY{o}{=} \PY{n}{i}\PY{o}{\PYZpc{}}\PY{k}{3}, int(np.floor(i/3))
    \PY{n}{axs}\PY{p}{[}\PY{n}{r}\PY{p}{,} \PY{n}{c}\PY{p}{]}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{kcentered\PYZus{}frames}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_79_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{61}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{median\PYZus{}no\PYZus{}sky\PYZus{}kband} \PY{o}{=} \PY{n}{kcentered\PYZus{}frames}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\PY{k}{for} \PY{n}{row} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{median\PYZus{}no\PYZus{}sky\PYZus{}kband}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{:}
    \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{median\PYZus{}no\PYZus{}sky\PYZus{}kband}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{:}
        \PY{c+c1}{\PYZsh{}print(str(row) + \PYZdq{} \PYZdq{} + str(col))}
        \PY{n}{median\PYZus{}no\PYZus{}sky\PYZus{}kband}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{row}\PY{p}{,} \PY{n}{col}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{median}\PY{p}{(}\PY{p}{[}\PY{n}{frame}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{row}\PY{p}{,} \PY{n}{col}\PY{p}{]} \PY{k}{for} \PY{n}{frame}
                                                       \PY{o+ow}{in} \PY{n}{kcentered\PYZus{}frames}\PY{p}{]}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{median\PYZus{}no\PYZus{}sky\PYZus{}kband}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{61}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
<matplotlib.colorbar.Colorbar at 0x7f147cce8430>
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_80_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{62}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{characterize}\PY{p}{(}\PY{n}{median\PYZus{}no\PYZus{}sky\PYZus{}kband}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
We now statistically characterize the pixel values in the above image.
The average is 0.17626825
The median is 0.0
The standard deviation is 341    1.250365
342    1.126779
343    1.191471
344    1.059143
345    1.043695
         {\ldots}
766    1.366601
767    1.373403
768    1.229293
769    1.344612
770    1.423204
Length: 430, dtype: float32
The median absolute deviation is 1.1119516638792015
A histogram of the pixel value is shown below.
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_81_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{l-band}{%
\subsection{L band}\label{l-band}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{63}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{lband\PYZus{}sky} \PY{o}{=} \PY{n}{get\PYZus{}median\PYZus{}frame}\PY{p}{(}\PY{n}{lband\PYZus{}dict}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sci}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{lband\PYZus{}sky}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{63}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
<matplotlib.colorbar.Colorbar at 0x7f147913c9a0>
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_83_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{64}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{characterize}\PY{p}{(}\PY{n}{lband\PYZus{}sky}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
We now statistically characterize the pixel values in the above image.
The average is -554.68097
The median is -422.31
The standard deviation is 1376.2347
The median absolute deviation is 1123.1157020201606
A histogram of the pixel value is shown below.
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_84_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{65}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{no\PYZus{}sky\PYZus{}lband\PYZus{}arr} \PY{o}{=} \PY{p}{[}\PY{n}{x}\PY{o}{\PYZhy{}} \PY{n}{lband\PYZus{}sky} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{lband\PYZus{}dict}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sci}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
\PY{k}{for} \PY{n}{coord\PYZus{}pair} \PY{o+ow}{in} \PY{n}{hband\PYZus{}bad\PYZus{}pixels}\PY{p}{:}
    \PY{k}{for} \PY{n}{frame\PYZus{}index} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{no\PYZus{}sky\PYZus{}lband\PYZus{}arr}\PY{p}{)}\PY{p}{)}\PY{p}{:}
        \PY{n}{no\PYZus{}sky\PYZus{}lband\PYZus{}arr}\PY{p}{[}\PY{n}{frame\PYZus{}index}\PY{p}{]}\PY{p}{[}\PY{n}{coord\PYZus{}pair}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}\PY{p}{[}\PY{n}{coord\PYZus{}pair}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{no\PYZus{}sky\PYZus{}lband\PYZus{}dicts} \PY{o}{=} \PY{p}{[}\PY{n}{characterize}\PY{p}{(}\PY{n}{frame}\PY{p}{,} \PY{k+kc}{True}\PY{p}{)} \PY{k}{for} \PY{n}{frame} \PY{o+ow}{in} \PY{n}{no\PYZus{}sky\PYZus{}lband\PYZus{}arr}\PY{p}{]}
\PY{n}{fig}\PY{p}{,} \PY{n}{axs} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{l+m+mi}{8}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{400}\PY{p}{)}
\PY{n}{lstar\PYZus{}positions} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{no\PYZus{}sky\PYZus{}lband\PYZus{}arr}\PY{p}{)}\PY{p}{)}\PY{p}{:}
    \PY{n}{final\PYZus{}image\PYZus{}cropped} \PY{o}{=} \PY{n}{no\PYZus{}sky\PYZus{}lband\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]}
    \PY{n}{bkg\PYZus{}sigma} \PY{o}{=} \PY{n}{no\PYZus{}sky\PYZus{}lband\PYZus{}dicts}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{median absolute deviation}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
    \PY{n}{filter\PYZus{}fwhm} \PY{o}{=} \PY{l+m+mi}{206265}\PY{o}{*}\PY{l+m+mf}{1630.0}\PY{o}{*}\PY{l+m+mf}{1.0e\PYZhy{}9}\PY{o}{/}\PY{l+m+mf}{8.2} \PY{o}{/} \PY{l+m+mf}{0.012}
    \PY{n}{coeffs} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{2000}\PY{p}{]}
    \PY{n}{max\PYZus{}tries} \PY{o}{=} \PY{l+m+mi}{15}
    \PY{n}{tries} \PY{o}{=} \PY{l+m+mi}{1}
    \PY{n}{coeff} \PY{o}{=} \PY{p}{(}\PY{n}{coeffs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{+} \PY{n}{coeffs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)} \PY{o}{/} \PY{l+m+mi}{2}
    \PY{n}{daofind} \PY{o}{=} \PY{n}{DAOStarFinder}\PY{p}{(}\PY{n}{fwhm} \PY{o}{=} \PY{n}{filter\PYZus{}fwhm}\PY{p}{,} \PY{n}{threshold} \PY{o}{=} \PY{n}{coeff}\PY{o}{*}\PY{n}{bkg\PYZus{}sigma}\PY{p}{)}
    \PY{n}{sources} \PY{o}{=} \PY{n}{daofind}\PY{p}{(}\PY{n}{final\PYZus{}image\PYZus{}cropped}\PY{p}{)}
    \PY{k}{while} \PY{p}{(}\PY{n}{sources} \PY{o+ow}{is} \PY{k+kc}{None} \PY{o+ow}{or} \PY{n+nb}{len}\PY{p}{(}\PY{n}{sources}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{l+m+mi}{1}\PY{p}{)} \PY{o+ow}{and} \PY{p}{(}\PY{n}{tries} \PY{o}{\PYZlt{}} \PY{n}{max\PYZus{}tries}\PY{p}{)}\PY{p}{:}
        \PY{n}{coeff} \PY{o}{=} \PY{p}{(}\PY{n}{coeffs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{+} \PY{n}{coeffs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)} \PY{o}{/} \PY{l+m+mi}{2}
        \PY{n}{daofind} \PY{o}{=} \PY{n}{DAOStarFinder}\PY{p}{(}\PY{n}{fwhm} \PY{o}{=} \PY{n}{filter\PYZus{}fwhm}\PY{p}{,} \PY{n}{threshold} \PY{o}{=} \PY{n}{coeff}\PY{o}{*}\PY{n}{bkg\PYZus{}sigma}\PY{p}{)}
        \PY{n}{sources} \PY{o}{=} \PY{n}{daofind}\PY{p}{(}\PY{n}{final\PYZus{}image\PYZus{}cropped}\PY{p}{)}
        \PY{n}{tries} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
        \PY{k}{if} \PY{n}{sources} \PY{o+ow}{is} \PY{k+kc}{None}\PY{p}{:}
            \PY{n}{coeffs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{=} \PY{n}{coeff} \PY{c+c1}{\PYZsh{}smaller threshold necessary}
        \PY{k}{else}\PY{p}{:}
            \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n}{sources}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{l+m+mi}{1}\PY{p}{:}
                \PY{n}{coeffs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{=} \PY{n}{coeff} \PY{c+c1}{\PYZsh{}larger threshold necessary}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Threshold is }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{coeff}\PY{p}{)} \PY{o}{+} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ times larger than the median absolute deviation}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{sources}\PY{o}{.}\PY{n}{colnames}\PY{p}{:}
        \PY{n}{sources}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{info}\PY{o}{.}\PY{n}{format} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.8g}\PY{l+s+s1}{\PYZsq{}}
    \PY{n+nb}{print}\PY{p}{(}\PY{n}{sources}\PY{p}{)}
    \PY{n}{positions} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{(}\PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xcentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ycentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
    \PY{n}{lstar\PYZus{}positions}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xcentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ycentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}
    \PY{n}{apertures} \PY{o}{=} \PY{n}{CircularAperture}\PY{p}{(}\PY{n}{positions}\PY{p}{,} \PY{n}{r}\PY{o}{=}\PY{n}{filter\PYZus{}fwhm}\PY{p}{)}
    \PY{n}{phot\PYZus{}table} \PY{o}{=} \PY{n}{aperture\PYZus{}photometry}\PY{p}{(}\PY{n}{final\PYZus{}image\PYZus{}cropped}\PY{p}{,} \PY{n}{apertures}\PY{p}{)}
    \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{phot\PYZus{}table}\PY{o}{.}\PY{n}{colnames}\PY{p}{:}
        \PY{n}{phot\PYZus{}table}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{info}\PY{o}{.}\PY{n}{format} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.8g}\PY{l+s+s1}{\PYZsq{}}
    \PY{n+nb}{print}\PY{p}{(}\PY{n}{phot\PYZus{}table}\PY{p}{)}
    \PY{n}{r}\PY{p}{,} \PY{n}{c} \PY{o}{=} \PY{n}{i}\PY{o}{\PYZpc{}}\PY{k}{8}, int(np.floor(i/8))
    \PY{n}{axs}\PY{p}{[}\PY{n}{r}\PY{p}{,} \PY{n}{c}\PY{p}{]}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{final\PYZus{}image\PYZus{}cropped}\PY{p}{,}\PY{n}{vmin}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{vmax}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{hot}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{c+c1}{\PYZsh{}apertures.plot(color = \PYZsq{}cyan\PYZsq{}, lw = 5, alpha = 0.75)}
    \PY{n}{axs}\PY{p}{[}\PY{n}{r}\PY{p}{,}\PY{n}{c}\PY{p}{]}\PY{o}{.}\PY{n}{add\PYZus{}patch}\PY{p}{(}
        \PY{n}{plt}\PY{o}{.}\PY{n}{Circle}\PY{p}{(}\PY{p}{(}\PY{n+nb}{int}\PY{p}{(}\PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xcentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n+nb}{int}\PY{p}{(}\PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ycentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{,} 
                   \PY{l+m+mi}{50}\PY{p}{,} \PY{n}{fill}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{blue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Threshold is 13.88671875 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky  peak     flux        mag
--- --------- --------- ---------- {\ldots} --- ------ --------- -------------
  1 949.04097 670.89141 0.29738472 {\ldots}   0 100.94 1.0032719 -0.0035466618
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 949.04097 670.89141     1353.746
Threshold is 25.546875 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky    peak      flux       mag
--- --------- --------- ---------- {\ldots} --- --------- --------- -----------
  1 303.62199 224.48744 0.34177226 {\ldots}   0 142.25999 1.2282968 -0.22325826
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 303.62199 224.48744    2244.8506
Threshold is 17.7734375 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky    peak      flux      mag
--- --------- --------- ---------- {\ldots} --- --------- --------- ----------
  1 937.58469 523.33031 0.25067389 {\ldots}   0 122.22003 1.2512795 -0.2433858
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 937.58469 523.33031    2203.1299
Threshold is 17.7734375 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky    peak      flux       mag
--- --------- --------- ---------- {\ldots} --- --------- --------- -----------
  1 225.87156 422.26405 0.36607302 {\ldots}   0 133.29999 1.3827088 -0.35182681
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 225.87156 422.26405    2262.8367
Threshold is 17.7734375 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky    peak      flux       mag
--- --------- --------- ---------- {\ldots} --- --------- --------- -----------
  1 732.01061 410.32944 0.29765585 {\ldots}   0 119.75995 1.1875243 -0.18660628
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 732.01061 410.32944    1851.4299
Threshold is 25.546875 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky    peak      flux        mag
--- --------- --------- ---------- {\ldots} --- --------- --------- -------------
  1 845.31157 233.66736 0.46505783 {\ldots}   0 158.04004 1.0045056 -0.0048809427
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 845.31157 233.66736    2366.4086
Threshold is 32.83447265625 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky    peak      flux        mag
--- --------- --------- ---------- {\ldots} --- --------- --------- -------------
  1 43.832428 300.25294 0.25681421 {\ldots}   0 160.04004 1.0010239 -0.0011111042
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 43.832428 300.25294    3896.0227
Threshold is 17.7734375 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky    peak     flux       mag
--- --------- --------- ---------- {\ldots} --- --------- -------- -----------
  1 549.19904 347.95362 0.40919749 {\ldots}   0 135.30005 1.342136 -0.31949133
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 549.19904 347.95362    1806.3101
Threshold is 17.7734375 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky    peak      flux       mag
--- --------- --------- ---------- {\ldots} --- --------- --------- -----------
  1 439.44786 814.77543 0.37983359 {\ldots}   0 154.51999 1.3676158 -0.33991029
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 439.44786 814.77543    2324.4013
Threshold is 28.5833740234375 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness {\ldots} sky    peak      flux        mag
--- --------- --------- --------- {\ldots} --- --------- --------- -------------
  1 44.268405 300.25123 0.2687667 {\ldots}   0 123.64001 1.0014696 -0.0015944398
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 44.268405 300.25123    2913.1963
Threshold is 17.7734375 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky  peak     flux       mag
--- --------- --------- ---------- {\ldots} --- ------ --------- ------------
  1 529.41591 361.35802 0.32970035 {\ldots}   0 127.88 1.0608337 -0.064118262
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 529.41591 361.35802    2068.4483
Threshold is 10.9716796875 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky  peak    flux       mag
--- --------- --------- ---------- {\ldots} --- ------ -------- ------------
  1 285.80143 943.51495 0.34379478 {\ldots}   0 123.44 1.039409 -0.041966226
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 285.80143 943.51495     1664.575
Threshold is 17.7734375 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky    peak      flux       mag
--- --------- --------- ---------- {\ldots} --- --------- --------- ------------
  1 683.57725 568.64271 0.36505053 {\ldots}   0 108.30005 1.0239795 -0.025728203
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 683.57725 568.64271    1896.5834
Threshold is 17.7734375 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky    peak     flux       mag
--- --------- --------- ---------- {\ldots} --- --------- -------- -----------
  1 248.51675 488.83064 0.38820294 {\ldots}   0 145.85999 1.239653 -0.23325033
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 248.51675 488.83064    2360.6356
Threshold is 25.546875 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky    peak      flux       mag
--- --------- --------- ---------- {\ldots} --- --------- --------- ------------
  1 933.00009 440.61921 0.32421653 {\ldots}   0 134.79999 1.0214365 -0.023028382
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 933.00009 440.61921    2499.3039
Threshold is 22.14599609375 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky    peak      flux        mag
--- --------- --------- ---------- {\ldots} --- --------- --------- -------------
  1 52.321301 139.60286 0.25499254 {\ldots}   0 149.54001 1.0017741 -0.0019244683
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 52.321301 139.60286    2654.7023
Threshold is 26.5185546875 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky    peak      flux        mag
--- --------- --------- ---------- {\ldots} --- --------- --------- --------------
  1 25.793955 431.49197 0.22317759 {\ldots}   0 133.15997 1.0007874 -0.00085454772
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 25.793955 431.49197    3001.6615
Threshold is 17.7734375 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky    peak     flux      mag
--- --------- --------- ---------- {\ldots} --- --------- ------- -----------
  1 873.07936 846.21594 0.39496471 {\ldots}   0 139.58002 1.11028 -0.11358133
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 873.07936 846.21594    2095.7819
Threshold is 17.7734375 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky    peak      flux       mag
--- --------- --------- ---------- {\ldots} --- --------- --------- ------------
  1 752.85926 811.29762 0.37115778 {\ldots}   0 150.98004 1.0190247 -0.020461809
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 752.85926 811.29762    2225.0319
Threshold is 17.7734375 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky    peak      flux       mag
--- --------- --------- ---------- {\ldots} --- --------- --------- -----------
  1 322.31768 258.61087 0.36904876 {\ldots}   0 152.47998 1.1864032 -0.18558073
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 322.31768 258.61087     2245.877
Threshold is 30.4052734375 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky    peak      flux       mag
--- --------- --------- ---------- {\ldots} --- --------- --------- ------------
  1 43.957191 300.28564 0.26142257 {\ldots}   0 145.46002 1.0018045 -0.001957414
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 43.957191 300.28564    3545.9646
Threshold is 17.7734375 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky    peak      flux       mag
--- --------- --------- ---------- {\ldots} --- --------- --------- ------------
  1   393.969  642.7544 0.32499425 {\ldots}   0 173.26001 1.0261395 -0.028016012
 id xcenter ycenter  aperture\_sum
      pix     pix
--- ------- -------- ------------
  1 393.969 642.7544    3297.1404
Threshold is 13.88671875 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky    peak      flux       mag
--- --------- --------- ---------- {\ldots} --- --------- --------- -----------
  1 832.79212 453.78537 0.20372447 {\ldots}   0 115.96001 1.1836756 -0.18308178
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 832.79212 453.78537    3072.8924
Threshold is 11.943359375 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky    peak      flux       mag
--- --------- --------- ---------- {\ldots} --- --------- --------- ------------
  1 231.22044 366.94798 0.37342423 {\ldots}   0 168.54001 1.0953696 -0.098901687
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 231.22044 366.94798    2820.9457
Threshold is 25.546875 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky    peak     flux       mag
--- --------- --------- ---------- {\ldots} --- --------- -------- ------------
  1 319.84811  661.2741 0.33175433 {\ldots}   0 136.73999 1.028092 -0.030079978
 id  xcenter  ycenter  aperture\_sum
       pix      pix
--- --------- -------- ------------
  1 319.84811 661.2741    2253.3027
Threshold is 11.943359375 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky    peak      flux       mag
--- --------- --------- ---------- {\ldots} --- --------- --------- ------------
  1 20.171558 411.95479 0.66871651 {\ldots}   0 117.09985 1.0565225 -0.059696864
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 20.171558 411.95479    968.86618
Threshold is 17.7734375 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky    peak      flux       mag
--- --------- --------- ---------- {\ldots} --- --------- --------- -----------
  1 442.32356 808.73037 0.35508064 {\ldots}   0 153.29999 1.3675727 -0.33987603
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 442.32356 808.73037    2322.9559
Threshold is 17.7734375 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky    peak      flux       mag
--- --------- --------- ---------- {\ldots} --- --------- --------- -----------
  1 702.86872  623.9156 0.41959605 {\ldots}   0 167.68005 1.3408912 -0.31848389
 id  xcenter  ycenter  aperture\_sum
       pix      pix
--- --------- -------- ------------
  1 702.86872 623.9156    2342.8529
Threshold is 17.7734375 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky  peak     flux       mag
--- --------- --------- ---------- {\ldots} --- ------ --------- -----------
  1 225.03888  856.6987 0.34813343 {\ldots}   0 151.12 1.2513452 -0.24344279
 id  xcenter  ycenter  aperture\_sum
       pix      pix
--- --------- -------- ------------
  1 225.03888 856.6987    2248.5977
Threshold is 17.7734375 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky    peak    flux      mag
--- --------- --------- ---------- {\ldots} --- --------- ------ -----------
  1 806.38535 870.68126 0.38832848 {\ldots}   0 140.26001 1.0617 -0.06500453
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 806.38535 870.68126    2251.9951
Threshold is 17.7734375 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky    peak      flux       mag
--- --------- --------- ---------- {\ldots} --- --------- --------- ------------
  1 944.23627  734.5082 0.37075126 {\ldots}   0 155.59998 1.0575615 -0.060764098
 id  xcenter  ycenter  aperture\_sum
       pix      pix
--- --------- -------- ------------
  1 944.23627 734.5082    2505.7336
Threshold is 35.3851318359375 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky    peak     flux        mag
--- --------- --------- ---------- {\ldots} --- --------- -------- -------------
  1 43.782695 300.25001 0.25847178 {\ldots}   0 285.20001 1.001159 -0.0012575883
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 43.782695 300.25001    7025.9127
Threshold is 13.88671875 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky    peak      flux       mag
--- --------- --------- ---------- {\ldots} --- --------- --------- ------------
  1 925.77899 236.00216 0.29590112 {\ldots}   0 130.88002 1.0386329 -0.041155157
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 925.77899 236.00216    2545.4205
Threshold is 19.716796875 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky   peak      flux       mag
--- --------- --------- ---------- {\ldots} --- -------- --------- ------------
  1 14.705361 1009.6094 0.23356443 {\ldots}   0 11.76001 1.0774081 -0.080950566
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 14.705361 1009.6094   -98.186215
Threshold is 17.7734375 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky    peak      flux       mag
--- --------- --------- ---------- {\ldots} --- --------- --------- ------------
  1 469.75602 542.08946 0.31966356 {\ldots}   0 119.51999 1.0102402 -0.011061612
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 469.75602 542.08946    1989.9406
Threshold is 27.490234375 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky    peak      flux        mag
--- --------- --------- ---------- {\ldots} --- --------- --------- -------------
  1 38.627234 427.10886 0.20414361 {\ldots}   0 124.10001 1.0018587 -0.0020161969
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 38.627234 427.10886     3605.088
Threshold is 17.7734375 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky    peak      flux       mag
--- --------- --------- ---------- {\ldots} --- --------- --------- ------------
  1 657.22564 862.30681 0.37534337 {\ldots}   0 122.16003 1.0879639 -0.091536252
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 657.22564 862.30681    1764.5094
Threshold is 17.7734375 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky    peak      flux       mag
--- --------- --------- ---------- {\ldots} --- --------- --------- ------------
  1 301.04671 939.19121 0.37374801 {\ldots}   0 162.69995 1.0057074 -0.006179096
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 301.04671 939.19121    2882.7588
Threshold is 16.558837890625 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky    peak      flux       mag
--- --------- --------- ---------- {\ldots} --- --------- --------- ------------
  1 52.324697 139.57959 0.23614369 {\ldots}   0 86.220032 1.0052991 -0.005738225
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 52.324697 139.57959    1591.9828
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_85_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{66}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{good\PYZus{}frame\PYZus{}indices} \PY{o}{=} \PY{p}{[}\PY{n}{i} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{no\PYZus{}sky\PYZus{}lband\PYZus{}arr}\PY{p}{)}\PY{p}{)} \PY{k}{if} \PY{n}{np}\PY{o}{.}\PY{n}{median}\PY{p}{(}\PY{n}{no\PYZus{}sky\PYZus{}lband\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)} \PY{o}{\PYZlt{}} \PY{l+m+mi}{100}\PY{p}{]}
\PY{n}{no\PYZus{}sky\PYZus{}lband\PYZus{}dfs} \PY{o}{=} \PY{p}{[}\PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{no\PYZus{}sky\PYZus{}lband\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{good\PYZus{}frame\PYZus{}indices}\PY{p}{]}
\PY{n}{lstar\PYZus{}positions} \PY{o}{=} \PY{p}{[}\PY{n}{lstar\PYZus{}positions}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{good\PYZus{}frame\PYZus{}indices}\PY{p}{]}
\PY{n}{lstar\PYZus{}x\PYZus{}arr} \PY{o}{=} \PY{p}{[}\PY{n+nb}{int}\PY{p}{(}\PY{n}{star\PYZus{}position}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{star\PYZus{}position} \PY{o+ow}{in} \PY{n}{lstar\PYZus{}positions}\PY{p}{]}
\PY{n}{lstar\PYZus{}y\PYZus{}arr} \PY{o}{=} \PY{p}{[}\PY{n+nb}{int}\PY{p}{(}\PY{n}{star\PYZus{}position}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{star\PYZus{}position} \PY{o+ow}{in} \PY{n}{lstar\PYZus{}positions}\PY{p}{]}
\PY{n}{top\PYZus{}left}\PY{p}{,} \PY{n}{bottom\PYZus{}right} \PY{o}{=} \PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{10}
\PY{n}{lcentered\PYZus{}frames} \PY{o}{=} \PY{p}{[}\PY{n}{no\PYZus{}sky\PYZus{}lband\PYZus{}dfs}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{lstar\PYZus{}y\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{top\PYZus{}left} \PY{p}{:} \PY{n}{lstar\PYZus{}y\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{+} \PY{n}{bottom\PYZus{}right} \PY{p}{,} 
                \PY{n}{lstar\PYZus{}x\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{\PYZhy{}} \PY{n}{top\PYZus{}left} \PY{p}{:} \PY{n}{lstar\PYZus{}x\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{+} \PY{n}{bottom\PYZus{}right}\PY{p}{]} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{lstar\PYZus{}y\PYZus{}arr}\PY{p}{)}\PY{p}{)} \PY{p}{]}
\PY{n}{fig}\PY{p}{,} \PY{n}{axs} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{l+m+mi}{8}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{400}\PY{p}{)}
\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{no\PYZus{}sky\PYZus{}lband\PYZus{}dfs}\PY{p}{)}\PY{p}{)}\PY{p}{:}
    \PY{n}{r}\PY{p}{,} \PY{n}{c} \PY{o}{=} \PY{n}{i}\PY{o}{\PYZpc{}}\PY{k}{8}, int(np.floor(i/8))
    \PY{n}{axs}\PY{p}{[}\PY{n}{r}\PY{p}{,} \PY{n}{c}\PY{p}{]}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{lcentered\PYZus{}frames}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_86_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{67}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{no\PYZus{}sky\PYZus{}lband\PYZus{}dfs} \PY{o}{=} \PY{n}{no\PYZus{}sky\PYZus{}lband\PYZus{}dfs}\PY{p}{[}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{omitting-the-l-band-for-the-sake-of-time-due-to-the-unusually-low-quality-of-the-data.}{%
\subsection{Omitting the L band for the sake of time due to the
unusually low quality of the
data.}\label{omitting-the-l-band-for-the-sake-of-time-due-to-the-unusually-low-quality-of-the-data.}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]

\end{Verbatim}
\end{tcolorbox}

    Accidentally including the hot and cold pixels would provide a false
confidence in the observations. Specifically, hot pixels would look like
point sources and cold pixels could prevent the detection of light from
any source, whether it be sky background or a celestial object.

    We will only subtract the dark flat from the flats in order to arrive at
the flats we will use for the data reduction for each wavelength band,
as shown above.

Now we will proceed by reducing the hband wavelength frames using the
following method. \begin{align}
\text{reduced} = \frac{\text{science} - \text{dark}}{\text{flat}-\text{bias}}
\end{align} where we perform this formula on each corresponding pixel in
each frame.

    \hypertarget{hband-master-bias}{%
\subsection{Hband Master Bias}\label{hband-master-bias}}

    Due to their short exposure, we will use the flat darks as the bias
frames.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{69}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{median\PYZus{}hband\PYZus{}bias} \PY{o}{=} \PY{n}{get\PYZus{}median\PYZus{}frame}\PY{p}{(}\PY{n}{hband\PYZus{}dict}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{flat darks}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{median\PYZus{}hband\PYZus{}bias}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{69}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
<matplotlib.colorbar.Colorbar at 0x7f148761a430>
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_94_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{70}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{characterize}\PY{p}{(}\PY{n}{median\PYZus{}hband\PYZus{}bias}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
We now statistically characterize the pixel values in the above image.
The average is 20.485004
The median is 18.6
The standard deviation is 30.232597
The median absolute deviation is 8.154312201780812
A histogram of the pixel value is shown below.
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_95_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{reducing-hband}{%
\subsection{Reducing Hband}\label{reducing-hband}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{74}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{reduce\PYZus{}band}\PY{p}{(}\PY{n}{science}\PY{p}{,} \PY{n}{dark}\PY{p}{,} \PY{n}{flat}\PY{p}{,} \PY{n}{bias}\PY{p}{)}\PY{p}{:}
    \PY{k}{return} \PY{p}{(}\PY{n}{science} \PY{o}{\PYZhy{}} \PY{n}{dark}\PY{p}{)} \PY{o}{/} \PY{p}{(}\PY{n}{flat} \PY{o}{\PYZhy{}} \PY{n}{bias}\PY{p}{)}
\PY{n}{not\PYZus{}centered\PYZus{}reduced\PYZus{}arr} \PY{o}{=} \PY{p}{[}\PY{n}{reduce\PYZus{}band}\PY{p}{(}\PY{n}{science}\PY{p}{,} \PY{n}{median\PYZus{}hband\PYZus{}dark}\PY{p}{,}
    \PY{n}{median\PYZus{}hband\PYZus{}flat}\PY{p}{,} \PY{n}{median\PYZus{}hband\PYZus{}bias}\PY{p}{)} 
    \PY{k}{for} \PY{n}{science}  \PY{o+ow}{in} \PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}arr}\PY{p}{]}
\PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}dfs} \PY{o}{=} \PY{p}{[}\PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{x}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}arr}\PY{p}{]}
\PY{n}{star\PYZus{}x\PYZus{}arr} \PY{o}{=} \PY{p}{[}\PY{n+nb}{int}\PY{p}{(}\PY{n}{star\PYZus{}position}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{star\PYZus{}position} \PY{o+ow}{in} \PY{n}{star\PYZus{}position\PYZus{}arr}\PY{p}{]}
\PY{n}{star\PYZus{}y\PYZus{}arr} \PY{o}{=} \PY{p}{[}\PY{n+nb}{int}\PY{p}{(}\PY{n}{star\PYZus{}position}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{star\PYZus{}position} \PY{o+ow}{in} \PY{n}{star\PYZus{}position\PYZus{}arr}\PY{p}{]}
\PY{c+c1}{\PYZsh{}size = min(min(star\PYZus{}x\PYZus{}arr), no\PYZus{}sky\PYZus{}hband\PYZus{}dfs[0].shape[0]\PYZhy{}max(star\PYZus{}x\PYZus{}arr),}
\PY{c+c1}{\PYZsh{}           min(star\PYZus{}y\PYZus{}arr), no\PYZus{}sky\PYZus{}hband\PYZus{}dfs[0].shape[1]\PYZhy{}min(star\PYZus{}y\PYZus{}arr))\PYZhy{}1}
\PY{c+c1}{\PYZsh{}print(\PYZdq{}maximum frame size: \PYZdq{} + str(size))}
\PY{n}{top\PYZus{}left} \PY{o}{=} \PY{l+m+mi}{300}
\PY{n}{centered\PYZus{}reduced\PYZus{}arr} \PY{o}{=} \PY{p}{[}\PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}dfs}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{star\PYZus{}y\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{top\PYZus{}left} \PY{p}{:} \PY{n}{star\PYZus{}y\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{+} \PY{l+m+mi}{50} \PY{p}{,} 
                \PY{n}{star\PYZus{}x\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{\PYZhy{}} \PY{n}{top\PYZus{}left} \PY{p}{:} \PY{n}{star\PYZus{}x\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{+} \PY{l+m+mi}{50}\PY{p}{]} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{star\PYZus{}y\PYZus{}arr}\PY{p}{)}\PY{p}{)} \PY{p}{]}
\PY{n}{fig}\PY{p}{,} \PY{n}{axs} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{400}\PY{p}{)}
\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{no\PYZus{}sky\PYZus{}hband\PYZus{}arr}\PY{p}{)}\PY{p}{)}\PY{p}{:}
    \PY{n}{r}\PY{p}{,} \PY{n}{c} \PY{o}{=} \PY{n}{i}\PY{o}{\PYZpc{}}\PY{k}{3}, int(np.floor(i/3))
    \PY{n}{axs}\PY{p}{[}\PY{n}{r}\PY{p}{,} \PY{n}{c}\PY{p}{]}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{centered\PYZus{}reduced\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
\PY{c+c1}{\PYZsh{}reduced\PYZus{}hband = (median\PYZus{}no\PYZus{}sky\PYZus{}hband \PYZhy{} median\PYZus{}hband\PYZus{}dark) / (median\PYZus{}hband\PYZus{}flat \PYZhy{} median\PYZus{}hband\PYZus{}bias)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
/tmp/ipykernel\_6254/3055018359.py:2: RuntimeWarning: divide by zero encountered
in divide
  return (science - dark) / (flat - bias)
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_97_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{75}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{reduced\PYZus{}hband} \PY{o}{=} \PY{n}{get\PYZus{}median\PYZus{}frame}\PY{p}{(}\PY{n}{centered\PYZus{}reduced\PYZus{}arr}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{reduced\PYZus{}hband}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{75}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
<matplotlib.colorbar.Colorbar at 0x7f14774030d0>
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_98_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{76}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{characterize}\PY{p}{(}\PY{n}{reduced\PYZus{}hband}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
We now statistically characterize the pixel values in the above image.
The average is 0.51713926
The median is 0.0
The standard deviation is 14.3773575
The median absolute deviation is 0.9266263865660013
A histogram of the pixel value is shown below.
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_99_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{reducing-kband}{%
\subsection{Reducing Kband}\label{reducing-kband}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{77}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{median\PYZus{}kband\PYZus{}bias} \PY{o}{=} \PY{n}{get\PYZus{}median\PYZus{}frame}\PY{p}{(}\PY{n}{kband\PYZus{}dict}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{flat darks}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{median\PYZus{}kband\PYZus{}bias}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{77}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
<matplotlib.colorbar.Colorbar at 0x7f147549efa0>
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_101_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{78}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{characterize}\PY{p}{(}\PY{n}{median\PYZus{}kband\PYZus{}bias}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
We now statistically characterize the pixel values in the above image.
The average is 21.969515
The median is 20.0
The standard deviation is 42.8635
The median absolute deviation is 8.74735252361519
A histogram of the pixel value is shown below.
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_102_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{81}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{median\PYZus{}kband\PYZus{}dark} \PY{o}{=} \PY{n}{get\PYZus{}median\PYZus{}frame}\PY{p}{(}\PY{n}{kband\PYZus{}dict}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{darks}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{median\PYZus{}kband\PYZus{}flat} \PY{o}{=} \PY{n}{get\PYZus{}median\PYZus{}frame}\PY{p}{(}\PY{n}{kband\PYZus{}dict}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{flats}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{not\PYZus{}centered\PYZus{}reduced\PYZus{}arr} \PY{o}{=} \PY{p}{[}\PY{n}{reduce\PYZus{}band}\PY{p}{(}\PY{n}{science}\PY{p}{,} \PY{n}{median\PYZus{}kband\PYZus{}dark}\PY{p}{,}
    \PY{n}{median\PYZus{}kband\PYZus{}flat}\PY{p}{,} \PY{n}{median\PYZus{}kband\PYZus{}bias}\PY{p}{)} 
    \PY{k}{for} \PY{n}{science}  \PY{o+ow}{in} \PY{n}{no\PYZus{}sky\PYZus{}kband\PYZus{}arr}\PY{p}{]}
\PY{n}{no\PYZus{}sky\PYZus{}kband\PYZus{}dfs} \PY{o}{=} \PY{p}{[}\PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{x}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{no\PYZus{}sky\PYZus{}kband\PYZus{}arr}\PY{p}{]}
\PY{n}{star\PYZus{}x\PYZus{}arr} \PY{o}{=} \PY{p}{[}\PY{n+nb}{int}\PY{p}{(}\PY{n}{star\PYZus{}position}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{star\PYZus{}position} \PY{o+ow}{in} \PY{n}{kstar\PYZus{}positions}\PY{p}{]}
\PY{n}{star\PYZus{}y\PYZus{}arr} \PY{o}{=} \PY{p}{[}\PY{n+nb}{int}\PY{p}{(}\PY{n}{star\PYZus{}position}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{star\PYZus{}position} \PY{o+ow}{in} \PY{n}{kstar\PYZus{}positions}\PY{p}{]}
\PY{c+c1}{\PYZsh{}size = min(min(star\PYZus{}x\PYZus{}arr), no\PYZus{}sky\PYZus{}hband\PYZus{}dfs[0].shape[0]\PYZhy{}max(star\PYZus{}x\PYZus{}arr),}
\PY{c+c1}{\PYZsh{}           min(star\PYZus{}y\PYZus{}arr), no\PYZus{}sky\PYZus{}hband\PYZus{}dfs[0].shape[1]\PYZhy{}min(star\PYZus{}y\PYZus{}arr))\PYZhy{}1}
\PY{c+c1}{\PYZsh{}print(\PYZdq{}maximum frame size: \PYZdq{} + str(size))}
\PY{n}{top\PYZus{}left} \PY{o}{=} \PY{l+m+mi}{300}
\PY{n}{bottom\PYZus{}right} \PY{o}{=} \PY{l+m+mi}{50}
\PY{n}{kcentered\PYZus{}reduced\PYZus{}arr} \PY{o}{=} \PY{p}{[}\PY{n}{no\PYZus{}sky\PYZus{}kband\PYZus{}dfs}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{star\PYZus{}y\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{top\PYZus{}left} \PY{p}{:} \PY{n}{star\PYZus{}y\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{+} \PY{n}{bottom\PYZus{}right} \PY{p}{,} 
                \PY{n}{star\PYZus{}x\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{\PYZhy{}} \PY{n}{top\PYZus{}left} \PY{p}{:} \PY{n}{star\PYZus{}x\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{+} \PY{n}{bottom\PYZus{}right}\PY{p}{]} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{star\PYZus{}y\PYZus{}arr}\PY{p}{)}\PY{p}{)} \PY{p}{]}
\PY{n}{fig}\PY{p}{,} \PY{n}{axs} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{400}\PY{p}{)}
\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{no\PYZus{}sky\PYZus{}kband\PYZus{}arr}\PY{p}{)}\PY{p}{)}\PY{p}{:}
    \PY{n}{r}\PY{p}{,} \PY{n}{c} \PY{o}{=} \PY{n}{i}\PY{o}{\PYZpc{}}\PY{k}{3}, int(np.floor(i/3))
    \PY{n}{axs}\PY{p}{[}\PY{n}{r}\PY{p}{,} \PY{n}{c}\PY{p}{]}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{kcentered\PYZus{}reduced\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
    \PY{c+c1}{\PYZsh{}reduced\PYZus{}hband = (median\PYZus{}no\PYZus{}sky\PYZus{}hband \PYZhy{} median\PYZus{}hband\PYZus{}dark) / (median\PYZus{}hband\PYZus{}flat \PYZhy{} median\PYZus{}hband\PYZus{}bias)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
/tmp/ipykernel\_6254/1622571316.py:2: RuntimeWarning: divide by zero encountered
in divide
  return (science - dark) / (flat - bias)
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_103_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{82}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{reduced\PYZus{}kband} \PY{o}{=} \PY{n}{get\PYZus{}median\PYZus{}frame}\PY{p}{(}\PY{n}{kcentered\PYZus{}reduced\PYZus{}arr}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{reduced\PYZus{}kband}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{82}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
<matplotlib.colorbar.Colorbar at 0x7f147a58fa60>
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_104_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{83}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{characterize}\PY{p}{(}\PY{n}{reduced\PYZus{}kband}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
We now statistically characterize the pixel values in the above image.
The average is 0.30450204
The median is 0.0
The standard deviation is 8.585142
The median absolute deviation is 1.1119516638792015
A histogram of the pixel value is shown below.
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_105_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{reducing-jband}{%
\subsection{Reducing Jband}\label{reducing-jband}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{85}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{median\PYZus{}jband\PYZus{}dark} \PY{o}{=} \PY{n}{get\PYZus{}median\PYZus{}frame}\PY{p}{(}\PY{n}{jband\PYZus{}dict}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{darks}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{median\PYZus{}jband\PYZus{}flat} \PY{o}{=} \PY{n}{get\PYZus{}median\PYZus{}frame}\PY{p}{(}\PY{n}{jband\PYZus{}dict}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{flats}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{median\PYZus{}jband\PYZus{}bias} \PY{o}{=} \PY{n}{get\PYZus{}median\PYZus{}frame}\PY{p}{(}\PY{n}{jband\PYZus{}dict}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{flat darks}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{not\PYZus{}centered\PYZus{}reduced\PYZus{}arr} \PY{o}{=} \PY{p}{[}\PY{n}{reduce\PYZus{}band}\PY{p}{(}\PY{n}{science}\PY{p}{,} \PY{n}{median\PYZus{}jband\PYZus{}dark}\PY{p}{,}
    \PY{n}{median\PYZus{}jband\PYZus{}flat}\PY{p}{,} \PY{n}{median\PYZus{}jband\PYZus{}bias}\PY{p}{)} 
    \PY{k}{for} \PY{n}{science}  \PY{o+ow}{in} \PY{n}{no\PYZus{}sky\PYZus{}jband\PYZus{}arr}\PY{p}{]}
\PY{n}{no\PYZus{}sky\PYZus{}jband\PYZus{}dfs} \PY{o}{=} \PY{p}{[}\PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{x}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{no\PYZus{}sky\PYZus{}jband\PYZus{}arr}\PY{p}{]}
\PY{n}{star\PYZus{}x\PYZus{}arr} \PY{o}{=} \PY{p}{[}\PY{n+nb}{int}\PY{p}{(}\PY{n}{star\PYZus{}position}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{star\PYZus{}position} \PY{o+ow}{in} \PY{n}{jstar\PYZus{}positions}\PY{p}{]}
\PY{n}{star\PYZus{}y\PYZus{}arr} \PY{o}{=} \PY{p}{[}\PY{n+nb}{int}\PY{p}{(}\PY{n}{star\PYZus{}position}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{star\PYZus{}position} \PY{o+ow}{in} \PY{n}{jstar\PYZus{}positions}\PY{p}{]}
\PY{c+c1}{\PYZsh{}size = min(min(star\PYZus{}x\PYZus{}arr), no\PYZus{}sky\PYZus{}hband\PYZus{}dfs[0].shape[0]\PYZhy{}max(star\PYZus{}x\PYZus{}arr),}
\PY{c+c1}{\PYZsh{}           min(star\PYZus{}y\PYZus{}arr), no\PYZus{}sky\PYZus{}hband\PYZus{}dfs[0].shape[1]\PYZhy{}min(star\PYZus{}y\PYZus{}arr))\PYZhy{}1}
\PY{c+c1}{\PYZsh{}print(\PYZdq{}maximum frame size: \PYZdq{} + str(size))}
\PY{n}{top\PYZus{}left} \PY{o}{=} \PY{l+m+mi}{300}
\PY{n}{bottom\PYZus{}right} \PY{o}{=} \PY{l+m+mi}{50}
\PY{n}{jcentered\PYZus{}reduced\PYZus{}arr} \PY{o}{=} \PY{p}{[}\PY{n}{no\PYZus{}sky\PYZus{}jband\PYZus{}dfs}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{star\PYZus{}y\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{top\PYZus{}left} \PY{p}{:} \PY{n}{star\PYZus{}y\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{+} \PY{n}{bottom\PYZus{}right} \PY{p}{,} 
                \PY{n}{star\PYZus{}x\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{\PYZhy{}} \PY{n}{top\PYZus{}left} \PY{p}{:} \PY{n}{star\PYZus{}x\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{+} \PY{n}{bottom\PYZus{}right}\PY{p}{]} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{star\PYZus{}y\PYZus{}arr}\PY{p}{)}\PY{p}{)} \PY{p}{]}
\PY{n}{fig}\PY{p}{,} \PY{n}{axs} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{400}\PY{p}{)}
\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{no\PYZus{}sky\PYZus{}jband\PYZus{}arr}\PY{p}{)}\PY{p}{)}\PY{p}{:}
    \PY{n}{r}\PY{p}{,} \PY{n}{c} \PY{o}{=} \PY{n}{i}\PY{o}{\PYZpc{}}\PY{k}{3}, int(np.floor(i/3))
    \PY{n}{axs}\PY{p}{[}\PY{n}{r}\PY{p}{,} \PY{n}{c}\PY{p}{]}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{jcentered\PYZus{}reduced\PYZus{}arr}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
/tmp/ipykernel\_6254/1622571316.py:2: RuntimeWarning: divide by zero encountered
in divide
  return (science - dark) / (flat - bias)
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_107_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{86}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{reduced\PYZus{}jband} \PY{o}{=} \PY{n}{get\PYZus{}median\PYZus{}frame}\PY{p}{(}\PY{n}{jcentered\PYZus{}reduced\PYZus{}arr}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{reduced\PYZus{}jband}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{86}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
<matplotlib.colorbar.Colorbar at 0x7f14781fe820>
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_108_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{87}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{characterize}\PY{p}{(}\PY{n}{reduced\PYZus{}jband}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
We now statistically characterize the pixel values in the above image.
The average is 0.22236837
The median is -0.125
The standard deviation is 7.9404006
The median absolute deviation is 0.9266263865660013
A histogram of the pixel value is shown below.
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_109_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{now-to-find-the-location-of-the-star-and-planet-in-the-reduced-frame-for-each-wavelength-band}{%
\subsection{Now to find the location of the star and planet in the
reduced frame for each wavelength
band}\label{now-to-find-the-location-of-the-star-and-planet-in-the-reduced-frame-for-each-wavelength-band}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{90}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{reduced\PYZus{}bands} \PY{o}{=} \PY{p}{[}\PY{n}{reduced\PYZus{}hband}\PY{p}{,} \PY{n}{reduced\PYZus{}kband}\PY{p}{,} \PY{n}{reduced\PYZus{}jband}\PY{p}{]}
\PY{n}{reduced\PYZus{}band\PYZus{}dicts} \PY{o}{=} \PY{p}{[}\PY{n}{characterize}\PY{p}{(}\PY{n}{frame}\PY{p}{,} \PY{k+kc}{True}\PY{p}{)} \PY{k}{for} \PY{n}{frame} \PY{o+ow}{in} \PY{n}{reduced\PYZus{}bands}\PY{p}{]}
\PY{n}{fig}\PY{p}{,} \PY{n}{axs} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{400}\PY{p}{)}
\PY{n}{object\PYZus{}positions} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{reduced\PYZus{}bands}\PY{p}{)}\PY{p}{)}\PY{p}{:}
    \PY{n}{final\PYZus{}image\PYZus{}cropped} \PY{o}{=} \PY{n}{reduced\PYZus{}bands}\PY{p}{[}\PY{n}{i}\PY{p}{]}
    \PY{n}{bkg\PYZus{}sigma} \PY{o}{=} \PY{n}{reduced\PYZus{}band\PYZus{}dicts}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{median absolute deviation}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
    \PY{n}{filter\PYZus{}fwhm} \PY{o}{=} \PY{l+m+mi}{206265}\PY{o}{*}\PY{l+m+mf}{1630.0}\PY{o}{*}\PY{l+m+mf}{1.0e\PYZhy{}9}\PY{o}{/}\PY{l+m+mf}{8.2} \PY{o}{/} \PY{l+m+mf}{0.012}
    \PY{n}{coeffs} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{2000}\PY{p}{]}
    \PY{n}{max\PYZus{}tries} \PY{o}{=} \PY{l+m+mi}{15}
    \PY{n}{tries} \PY{o}{=} \PY{l+m+mi}{1}
    \PY{n}{coeff} \PY{o}{=} \PY{p}{(}\PY{n}{coeffs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{+} \PY{n}{coeffs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)} \PY{o}{/} \PY{l+m+mi}{2}
    \PY{n}{daofind} \PY{o}{=} \PY{n}{DAOStarFinder}\PY{p}{(}\PY{n}{fwhm} \PY{o}{=} \PY{n}{filter\PYZus{}fwhm}\PY{p}{,} \PY{n}{threshold} \PY{o}{=} \PY{n}{coeff}\PY{o}{*}\PY{n}{bkg\PYZus{}sigma}\PY{p}{)}
    \PY{n}{sources} \PY{o}{=} \PY{n}{daofind}\PY{p}{(}\PY{n}{final\PYZus{}image\PYZus{}cropped}\PY{p}{)}
    \PY{k}{while} \PY{p}{(}\PY{n}{sources} \PY{o+ow}{is} \PY{k+kc}{None} \PY{o+ow}{or} \PY{n+nb}{len}\PY{p}{(}\PY{n}{sources}\PY{p}{)} \PY{o}{!=} \PY{l+m+mi}{2}\PY{p}{)} \PY{o+ow}{and} \PY{p}{(}\PY{n}{tries} \PY{o}{\PYZlt{}} \PY{n}{max\PYZus{}tries}\PY{p}{)}\PY{p}{:}
        \PY{n}{coeff} \PY{o}{=} \PY{p}{(}\PY{n}{coeffs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{+} \PY{n}{coeffs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)} \PY{o}{/} \PY{l+m+mi}{2}
        \PY{n}{daofind} \PY{o}{=} \PY{n}{DAOStarFinder}\PY{p}{(}\PY{n}{fwhm} \PY{o}{=} \PY{n}{filter\PYZus{}fwhm}\PY{p}{,} \PY{n}{threshold} \PY{o}{=} \PY{n}{coeff}\PY{o}{*}\PY{n}{bkg\PYZus{}sigma}\PY{p}{)}
        \PY{n}{sources} \PY{o}{=} \PY{n}{daofind}\PY{p}{(}\PY{n}{final\PYZus{}image\PYZus{}cropped}\PY{p}{)}
        \PY{n}{tries} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
        \PY{k}{if} \PY{n}{sources} \PY{o+ow}{is} \PY{k+kc}{None}\PY{p}{:}
            \PY{n}{coeffs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{=} \PY{n}{coeff} \PY{c+c1}{\PYZsh{}smaller threshold necessary}
        \PY{k}{else}\PY{p}{:}
            \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n}{sources}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{l+m+mi}{2}\PY{p}{:}
                \PY{n}{coeffs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{=} \PY{n}{coeff} \PY{c+c1}{\PYZsh{}larger threshold necessary}
            \PY{k}{else}\PY{p}{:}
                \PY{n}{coeffs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{=} \PY{n}{coeff} \PY{c+c1}{\PYZsh{}smaller threshold necessary}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Threshold is }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{coeff}\PY{p}{)} \PY{o}{+} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ times larger than the median absolute deviation}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{sources}\PY{o}{.}\PY{n}{colnames}\PY{p}{:}
        \PY{n}{sources}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{info}\PY{o}{.}\PY{n}{format} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.8g}\PY{l+s+s1}{\PYZsq{}}
    \PY{n+nb}{print}\PY{p}{(}\PY{n}{sources}\PY{p}{)}
    \PY{n}{positions} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{(}\PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xcentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ycentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
    \PY{n}{object\PYZus{}positions}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{[}\PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xcentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ycentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}
    \PY{n}{apertures} \PY{o}{=} \PY{n}{CircularAperture}\PY{p}{(}\PY{n}{positions}\PY{p}{,} \PY{n}{r}\PY{o}{=}\PY{n}{filter\PYZus{}fwhm}\PY{p}{)}
    \PY{n}{phot\PYZus{}table} \PY{o}{=} \PY{n}{aperture\PYZus{}photometry}\PY{p}{(}\PY{n}{final\PYZus{}image\PYZus{}cropped}\PY{p}{,} \PY{n}{apertures}\PY{p}{)}
    \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{phot\PYZus{}table}\PY{o}{.}\PY{n}{colnames}\PY{p}{:}
        \PY{n}{phot\PYZus{}table}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{info}\PY{o}{.}\PY{n}{format} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.8g}\PY{l+s+s1}{\PYZsq{}}
    \PY{n+nb}{print}\PY{p}{(}\PY{n}{phot\PYZus{}table}\PY{p}{)}
    \PY{n}{axs}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{final\PYZus{}image\PYZus{}cropped}\PY{p}{,}\PY{n}{vmin}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{vmax}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{hot}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{c+c1}{\PYZsh{}apertures.plot(color = \PYZsq{}cyan\PYZsq{}, lw = 5, alpha = 0.75)}
    \PY{n}{axs}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{add\PYZus{}patch}\PY{p}{(}
        \PY{n}{plt}\PY{o}{.}\PY{n}{Circle}\PY{p}{(}\PY{p}{(}\PY{n+nb}{int}\PY{p}{(}\PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xcentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n+nb}{int}\PY{p}{(}\PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ycentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{,} 
                   \PY{l+m+mi}{50}\PY{p}{,} \PY{n}{fill}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{blue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{p}{)}
    \PY{n}{axs}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{add\PYZus{}patch}\PY{p}{(}
        \PY{n}{plt}\PY{o}{.}\PY{n}{Circle}\PY{p}{(}\PY{p}{(}\PY{n+nb}{int}\PY{p}{(}\PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xcentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n+nb}{int}\PY{p}{(}\PY{n}{sources}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ycentroid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{,} 
                   \PY{l+m+mi}{50}\PY{p}{,} \PY{n}{fill}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{blue}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Threshold is 134.375 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky    peak      flux       mag
--- --------- --------- ---------- {\ldots} --- --------- --------- -----------
  1 64.600408 132.49708 0.46791794 {\ldots}   0  221.8125 1.2545927 -0.24625685
  2 300.35328 300.54646 0.49924465 {\ldots}   0 2003.5625 11.400593  -2.6423186
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 64.600408 132.49708    2686.1089
  2 300.35328 300.54646    23113.759
Threshold is 41.09375 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky  peak     flux       mag
--- --------- --------- ---------- {\ldots} --- ------ --------- -----------
  1 65.205999 133.03818 0.54916211 {\ldots}   0 110.25 1.7333314 -0.59720404
  2 300.52946 300.65567 0.55455755 {\ldots}   0 1290.5 19.359669  -3.2172448
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 65.205999 133.03818    1040.5963
  2 300.52946 300.65567    13362.368
Threshold is 41.09375 times larger than the median absolute deviation
 id xcentroid ycentroid sharpness  {\ldots} sky   peak     flux       mag
--- --------- --------- ---------- {\ldots} --- ------- --------- -----------
  1 64.474479 131.92915 0.34776475 {\ldots}   0    81.5 1.2483732 -0.24086105
  2  300.4547 300.11566 0.43662186 {\ldots}   0 753.375 11.090682  -2.6123956
 id  xcenter   ycenter  aperture\_sum
       pix       pix
--- --------- --------- ------------
  1 64.474479 131.92915    1486.5375
  2  300.4547 300.11566    12827.454
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{editing_Ay105Lab8_HBand-StarterNotebook_files/editing_Ay105Lab8_HBand-StarterNotebook_111_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{94}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{object\PYZus{}positions}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{94}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
[[<Column name='xcentroid' dtype='float64' format='\%.8g' length=2>
  64.600408
  300.35328,
  <Column name='ycentroid' dtype='float64' format='\%.8g' length=2>
  132.49708
  300.54646],
 [<Column name='xcentroid' dtype='float64' format='\%.8g' length=2>
  65.205999
  300.52946,
  <Column name='ycentroid' dtype='float64' format='\%.8g' length=2>
  133.03818
  300.65567],
 [<Column name='xcentroid' dtype='float64' format='\%.8g' length=2>
  64.474479
   300.4547,
  <Column name='ycentroid' dtype='float64' format='\%.8g' length=2>
  131.92915
  300.11566]]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{97}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{reduced\PYZus{}bands} \PY{o}{=} \PY{p}{[}\PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{x}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{reduced\PYZus{}bands}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{101}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{bounds} \PY{o}{=} \PY{l+m+mi}{10}
\PY{n}{planet\PYZus{}brightness\PYZus{}pixel\PYZus{}vals} \PY{o}{=} \PY{p}{[}\PY{n+nb}{sum}\PY{p}{(}\PY{n}{reduced\PYZus{}bands}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n+nb}{int}\PY{p}{(}\PY{n}{object\PYZus{}positions}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{bounds}\PY{p}{)}\PY{p}{:} 
                                                   \PY{n+nb}{int}\PY{p}{(}\PY{n}{object\PYZus{}positions}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{+} \PY{n}{bounds}\PY{p}{)}\PY{p}{,} 
                            \PY{n+nb}{int}\PY{p}{(}\PY{n}{object\PYZus{}positions}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{bounds}\PY{p}{)} \PY{p}{:} \PY{n+nb}{int}\PY{p}{(}\PY{n}{object\PYZus{}positions}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{+} \PY{n}{bounds}\PY{p}{)}\PY{p}{]}\PY{p}{)}
                        \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{reduced\PYZus{}bands}\PY{p}{)}\PY{p}{)}\PY{p}{]}
\PY{n}{star\PYZus{}brightness\PYZus{}pixel\PYZus{}vals} \PY{o}{=} \PY{p}{[}\PY{n+nb}{sum}\PY{p}{(}\PY{n}{reduced\PYZus{}bands}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n+nb}{int}\PY{p}{(}\PY{n}{object\PYZus{}positions}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{bounds}\PY{p}{)}\PY{p}{:} 
                                                   \PY{n+nb}{int}\PY{p}{(}\PY{n}{object\PYZus{}positions}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{+} \PY{n}{bounds}\PY{p}{)}\PY{p}{,} 
                            \PY{n+nb}{int}\PY{p}{(}\PY{n}{object\PYZus{}positions}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{\PYZhy{}} \PY{n}{bounds}\PY{p}{)} \PY{p}{:} \PY{n+nb}{int}\PY{p}{(}\PY{n}{object\PYZus{}positions}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{+} \PY{n}{bounds}\PY{p}{)}\PY{p}{]}\PY{p}{)}
                        \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{reduced\PYZus{}bands}\PY{p}{)}\PY{p}{)}\PY{p}{]}
\PY{n}{brightness\PYZus{}pixel\PYZus{}ratios} \PY{o}{=} \PY{p}{[}\PY{n}{planet\PYZus{}brightness\PYZus{}pixel\PYZus{}vals1}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{/} \PY{n}{brightness\PYZus{}pixel\PYZus{}vals}\PY{p}{[}\PY{n}{i}\PY{p}{]} 
                           \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{reduced\PYZus{}bands}\PY{p}{)}\PY{p}{)}\PY{p}{]}
\PY{n}{brightness\PYZus{}pixel\PYZus{}ratios}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{101}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
[1.0, 1.0, 1.0]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]

\end{Verbatim}
\end{tcolorbox}

    \hypertarget{hband-master-science}{%
\subsection{Hband Master Science}\label{hband-master-science}}

    A collaborator contributed the following: Dictionary of all usable files
and our object's position in said files

posdict = \{\} posdict{[}``H''{]} = {[}(582, 597), (753, 722), (375,
610), (490, 407), (581, 596), (365, 405), (396, 607), (738, 412){]}
posdict{[}``J''{]} = {[}(626, 619), (479, 498), (500, 747), (794,
589){]} posdict{[}``K''{]} = {[}(621, 611), (822, 600), (484, 782),
(835, 411), (581, 596), (407, 439), (742, 429), (780, 796){]}

The bulk of the code. I construct a few dictionaries with all the
possible master files and raw files. Those are the dictionaries that I
am referencing here, hopefully its clear.

def generate\_outputs(): bands = {[}``H'', ``J'', ``K''{]} mag\_bands =
\{\} for band in bands: mag\_bands{[}band{]} = {[}{]} hot\_pixels =
sigma\_mask(masterdict{[}band{]}{[}``darks''{]}{[}1{]}){[}0{]}
cold\_pixels =
sigma\_mask(masterdict{[}band{]}{[}``flats''{]}{[}1{]}){[}0{]}
bad\_pixels = hot\_pixels + cold\_pixels bad\_mask = np.zeros((1024,
1024)) + bad\_pixels/bad\_pixels for row in bad\_mask:
np.nan\_to\_num(row, 0) for index, file in
enumerate(filedict{[}band{]}{[}``sci''{]}): sky\_no\_background =
fits.open(file){[}0{]}.data - masterdict{[}band{]}{[}``sci''{]}{[}1{]}
full\_output = sky\_no\_background * (1 - bad\_mask) hdu =
fits.PrimaryHDU(full\_output) path\_input = `./2M1207\_bands/' + band +
`band/' path\_output = path\_input + `out/' sep=`/' file\_id =
file.replace(f``./2M1207\_bands/\{band\}band/sci/'',
'`).replace('.fits','`) hdu.writeto(path\_output + file\_id
+'\_out.fits', overwrite=True) cropped\_output =
crop\_array(full\_output, posdict{[}band{]}{[}index{]}{[}1{]},
posdict{[}band{]}{[}index{]}{[}0{]})
mag\_bands{[}band{]}.append(determine\_mag(cropped\_output)) return
mag\_bands

Cropping helper function, aligns image with its corresponding position
in the position dictionary. Builds a 2nx2n data array centered on the
object

def crop\_array(datap, x\_center, y\_center): """ Returns a cropped
array of dimensions 2nx2n """ n = 50 return datap{[}x\_center -
n:x\_center + n,y\_center-n:y\_center + n{]}

Function that generates the magnitude and flux values for the SED. The
code in the notebook originally had a shitty finding algorithm to find
the object but I found it to be inconsistent, so I used the fact that
the cropped images were very well aligned and manually defined the
aperture to be centered on the exoplanet. The exoplanet does not seem to
move all to much so it ends up working out

def determine\_mag(data): bkg\_sigma = mad\_std(median\_output)
filter\_fwhm = 206265\emph{1630.0}1.0e-9/8.2 / 0.012 daofind =
DAOStarFinder(fwhm = filter\_fwhm, threshold = 2.0*bkg\_sigma) sources =
daofind(data) for col in sources.colnames: sources{[}col{]}.info.format
= `\%.8g'

\begin{verbatim}
positions = np.transpose((sources['xcentroid'], sources['ycentroid']))
apertures = CircularAperture([[25.73661874, 32.59190509],[49.5,
\end{verbatim}

49.5{]}{]}, r=filter\_fwhm) phot\_table = aperture\_photometry(data,
apertures) plt.figure(figsize = {[}20,20{]})
plt.imshow(data,vmin=0,vmax=20,cmap=`hot') plt.colorbar()
apertures.plot(color = `cyan', lw = 5, alpha = 0.75) for col in
phot\_table.colnames: phot\_table{[}col{]}.info.format = `\%.8g'
planet\_counts = np.min(phot\_table{[}``aperture\_sum''{]}) star\_counts
= np.max(phot\_table{[}``aperture\_sum''{]}) FluxRatio = planet\_counts
/ star\_counts print(``Planet Mag ='', -2.5\emph{np.log10(FluxRatio) +
12.388) return -2.5}np.log10(FluxRatio) + 12.388

Some of the lines in the function may be deprecated so there is some
stuff you can trim out.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{hband\PYZus{}dict}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{sci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
\PY{n}{bounds} \PY{o}{=} \PY{l+m+mi}{3}
\PY{n}{test} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{l+m+mi}{582}\PY{o}{\PYZhy{}}\PY{n}{bounds}\PY{p}{:}\PY{l+m+mi}{582}\PY{o}{+}\PY{n}{bounds}\PY{p}{,} \PY{l+m+mi}{597}\PY{o}{\PYZhy{}}\PY{n}{bounds}\PY{p}{:}\PY{l+m+mi}{597}\PY{o}{+}\PY{n}{bounds}\PY{p}{]}\PY{o}{.}\PY{n}{to\PYZus{}numpy}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{test}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{hband\PYZus{}dict}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{sci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{median\PYZus{}hband\PYZus{}sci} \PY{o}{=} \PY{n}{get\PYZus{}median\PYZus{}frame}\PY{p}{(}\PY{n}{hband\PYZus{}dict}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{sci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{median\PYZus{}hband\PYZus{}sci}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]

\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{hband\PYZus{}dict}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    bkg\_sigma = mad\_std(final\_image\_cropped) filter\_fwhm =
206265\emph{1630.0}1.0e-9/8.2 / 0.012 daofind = DAOStarFinder(fwhm =
filter\_fwhm, threshold = 3.0*bkg\_sigma) sources =
daofind(final\_image\_cropped) for col in sources.colnames:
sources{[}col{]}.info.format = `\%.8g' print(sources)

from photutils import aperture\_photometry, CircularAperture positions =
np.transpose((sources{[}`xcentroid'{]}, sources{[}`ycentroid'{]}))
apertures = CircularAperture(positions, r=filter\_fwhm) phot\_table =
aperture\_photometry(final\_image\_cropped, apertures) for col in
phot\_table.colnames: phot\_table{[}col{]}.info.format = `\%.8g'
print(phot\_table)

plt.figure(figsize = {[}20,20{]})
plt.imshow(final\_image\_cropped,vmin=0,vmax=20,cmap=`hot')
plt.colorbar() apertures.plot(color = `cyan', lw = 5, alpha = 0.75)

    print(bkg\_sigma) FluxRatio =
phot\_table{[}1{]}{[}3{]}/phot\_table{[}2{]}{[}3{]} print(``Planet Mag
='', -2.5*np.log10(FluxRatio) + 12.388)

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]

\end{Verbatim}
\end{tcolorbox}


    % Add a bibliography block to the postdoc
    
    
    
\end{document}
